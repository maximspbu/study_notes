---
layout: default
---
# 23.04.24

### Теорема. Достаточное условие дифференцируемости ФНП.
Доказательство:
$\displaystyle h\in\R^d~~x^0+h\in B(x^0).\\R(h):=f(x^0+h)-f(x^0)-\sum_{k=1}^{d}\frac{\partial f}{\partial x_k}(x^0)h_k$. Докажем, что
$\displaystyle R(h)=o(h),~h\to0_d.~V^k=(h_1\dots h_k0\dots0),~V^0=0_d\\
V^d=(h_1\dots h_d)=h.~R(h)=\underbrace{\sum_{k=1}^df(x^0+V^k)-f(x^0+V^{k+1})}_{=f(x^0+h)-f(x^0)}-\sum_{k=1}^d\frac{\partial f}{\partial x_k}(x^0)h_k$. $g(t):=f(x^0+V^{k-1}+th_ke^k)~~t\in[0,1]$
$\displaystyle g(0)=f(x^0+V^{k-1}),~g(1)=f(x^0+V^k)\\g'(t)=f'(x^0+V^{k-1}+th_ke^k)*h_ke^k=\frac{\partial f}{\partial x_k}(x^0V^{k-1}+th_ke^k)*h_k$
 $|x^0+V^{k-1}+th_ke^k|=\sqrt{h_1^2+\dots+h_{k-1}^2+(th_k)^2}\le\sqrt{h_1^2+\dots+h_k^2+h_d^2}=|h|$. $x^0+V^{k-1}+th_ke^k\in B(x^0)$
По теореме Лагранжа: $\exist\theta\in(0,1)~~g(1)-g(0)=g'(\theta)(1-0)$
$\displaystyle \underbrace{f(x^0+V^k)}_{g(1)}-\underbrace{f(x^0+V^{k-1})}_{g(0)}=\underbrace{\frac{\partial f}{\partial x_k}(x^0+V^{k-1}+\theta h_ke^k)}_{g'(\theta)}h_k$
$\displaystyle R(h)=\sum^d_{k=1}\underbrace{(\frac{\partial f}{\partial x_k}(x^0+V^{k-1}+\theta h_ke^k)-\frac{\partial f}{\partial x_k}(x^0)}_{\gamma_k(h)})$
$\displaystyle|V^{k-1}+\theta h_ke^k|\le|h|\to0_d~~\frac{\partial f}{\partial x_k}\text{непр в }x_0\lrArr\\\lrArr|\frac{\partial f}{\partial x_k}(x)-\frac{\partial f}{\partial x_k}(x^0)|_{x\to x_0}\to0$
$\displaystyle R(h)=|\sum_{k=1}^d\gamma_k(h)h_k|\underset{\text{КБШ}}{\le}\sqrt{\sum_{k=1}^d\gamma_k^2(h)}*\sqrt{\sum_{k=1}^dh_k^2}$
По определению $o(x)~~R(h)=o(h),h\to0_d.\blacksquare$

### Замечание:
Условие не является необходимым, например, в $\R^1$ случае.

### Пример. Функция дифференцируема в $(0,0)$, но не имеет частичной производной во всех остальных точках.
$f(x,y)=\begin{cases}
x^2+y^2,x\in Q~|~y\in Q\\
0,~\text{остальные случаи}
\end{cases}$
$f(0,0)=0$. $x^2+y^2=o(\sqrt{x^2+y^2}),~(x,y)\to(0,0)$
$\displaystyle\frac{x^2+y^2}{\sqrt{x^2+y^2}}=\sqrt{x^2+y^2}\underset{(x,y)\to(0,0)}{\to}0$. 
$f(x,y)=f(0,0)+o(\sqrt{x^2+y^2})~-~$условно дифференцируема в $0,0$.
$f'_x(0,0)=0~~f'_y(0,0)=0.~(x,y)\neq(0,0)~g_1(t)=f(x+t,y)$, 
$g_2(t)=f(x,y+t)~-~$разрыв, $\displaystyle\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}$ не существуют.

### Определение. Частная производная второго порядка.
$\displaystyle f:D\sub\R^d\to\R,~x^0\in IntD,~\exist V_{x_0}:\frac{\partial f}{\partial x_k}$ определена в ней, то
$\displaystyle\frac{\partial}{\partial x}(\frac{\partial f}{\partial x_k})(x_k)~-~$частная производная $f$ второго порядка по $x_k,x_j$
$\displaystyle\frac{\partial}{\partial x_j}(\frac{\partial f}{\partial x_k})=\frac{\partial^2f}{\partial x_kx_j}=f''_{x_kx_j}=D^2_{x_kx_j}f=D^2_{kj}f$

### Определение. Частная производная высшего порядка.
$\displaystyle k_1\dots k_r\in\{1\dots d\},~~\frac{\partial^r f}{\partial x_{k_1}\dots\partial x_{k_r}}:=\frac{\partial}{\partial x_{k_r}}*\big(\frac{\partial^{r-1}f}{\partial x_{k_1}\dots\partial x_{k_r}}\big)$ называется частной производной высшего порядка.

### Определение. Смешанная производная.
Смешанной производной называется такая производная, которая дифференцируется по нескольким переменным.

### Замечание к смешанным производным:
$f''_{xy}\neq f''_{yx}$: $\displaystyle f(x,y)=\begin{cases}
xy\frac{x^2-y^2}{x^2+y^2},~(x,y)\neq(0,0)\\
0,~(x,y)=(0,0)
\end{cases}$  
$(x,y)=(0,0):$  $\displaystyle f'_x(0,0)=\underset{x\to0}{\lim}\frac{f(x,0)-f(0,0)}{x}=\underset{x\to0}{\lim}\frac{0}{x}=0$
$(x,y)\neq(0,0):$
$\displaystyle f_x'(x,y)=y(\frac{x^2-y^2}{x^2+y^2}+\frac{x*2x(x^2+y^2)-2x(x^2+y^2)}{(x^2+y^2)^2})$
$\displaystyle f_{xy}''(0,0)=\underset{y\to0}{\lim}\frac{f_x'(0,y)-f_x'(0,0)}{y}=\underset{y\to0}{\lim}\frac{-y-0}{y}=-1$
$\displaystyle f_y'(0,0)=\underset{y\to0}{\lim}\frac{f(0,y)-f(0,0)}{y}=0$
$\displaystyle f_x'(x,y)=-x\frac{y^4-x^4+4x^2y^2}{(x^2+y^2)^2}\\f_{yx}''(0,0)=\underset{x\to0}{\lim}\frac{f_y'(x,0)-f_y'(0,0)}{x}=\underset{x\to0}{\lim}\frac{x-0}{x}=1$

### Теорема. Равенство смешанных производных второго порядка.
$f:D\sub\R^2\to\R,~(x_0,y_0)\in IntD,~$если $f_{xy}'',f_{yx}''$ существуют в некотором $B((x_0,y_0))$ и $f_{xy}'',f_{yx}''$ непрерывны в $(x_0,y_0)$, тогда они равны: $f_{xy}''(x_0,y_0)=f_{yx}''(x_0,y_0)$.
Доказательство:
$(x_0+h,y_0+k),~h,k\in\R;~h,k>0$.
$F=f(x_0+h,y_0+k)-f(x_0+h,y_0)-f(x_0,y_0+k)+f(x_0,y_0)$
$\phi(s):=f(s,y_0+k)-f(s,y_0)$. $F=\phi(x_0+h)-\phi(x_0)\underset{\text{Т Лагранжа}}{=}\\=\phi'(x_0+\theta_1h)h~~\exist\theta_1\in(0,1)$.
$(f(s,y_0+k))_s'=f_x'(s,y_0+k)*1+f_y'(s,y_0+k)*\underbrace{(y_0+k)}_{=0}=f_x'(s,y_0+k)$
$F=(f_x'(x_0+\theta_1h,y_0+k)-f_x'(x_0+\theta_1h,y_0))h$.  $\overline{\phi}(t):=f'_x(s,t)$
$f'_x(s,y_0+k)-f'_x(s,y_0)=\overline{\phi}(y_0+k)-\overline{\phi}(y_0)\underset{\text{Т Лагранжа}}{=}\\=\overline{\phi}'(y_0+\theta_2k)k,~\theta_2\in(0,1)$.
$\overline{\phi}'(t)=f_{xy}''(s,t)=\overline{\phi}'(t)=f_{xy}''(x_0+\theta h,t)$.
$F=f_{xy}''(x_0+\theta_1h,y_0+\theta_2k)kh$. 
Повторим то же самое для другой смешанной производной:
$F=f(x_0+h,y_0+k)-f(x_0+h,y_0)-f(x_0,y_0+k)+f(x_0,y_0)$
$\psi(t):=f(x_0+h,t)-f(x_0,t)$
$F=\psi(y_0+k)-\psi(y_0)\underset{\text{Т Лагранжа}}{=}\psi'(y_0+\theta_3k)k=(f_y'(x_0+h,y_0+\theta_3k)-f'_y(x_0,y_0+\theta_3k))k=f''_{yx}(x+\theta_4h,y_0+\theta_3k)hk$.
$f''_{xy}(x_0+\theta_1h,y_0+\theta_2k)\cancel{kh}=f_{yx}''(x_0+\theta_4h,y_0+\theta_3k)\cancel{kh}\underset{(h,k)\to(0,0)}{\rArr}\\\rArr f_{xy}''(x_0,y_0)=f_{yx}''(x_0,y_0).\blacksquare$

### Определение. Гладкое отображение.
$r\in \N_0,~f:D\sub\R^d\to\R$
Если все частные производные до порядка $r$ включительно существуют и непрерывны в $D$, то говорят, что функция $r$-гладкая и пишут, что функция $f\in C^r(D)$.

Отображение $f=(f_1,\dots,f_m):D\to\R^m$ называется $r$-гладким, если все его координатные функции $r$ гладкие.

### Теорема. Равенство смешанных производны для ФНП.
$D~-~$открытое в $\R^d;~f\in C^r(\R);~r\in\N_0$.
$i_1\dots i_r\in\set{1\dots d},$ а $(k_1\dots k_r)~-~$перестановка $(i_1\dots i_r)$.
Тогда частная производная $\dfrac{\partial^rf(x)}{\partial x_{k_1}\dots\partial x_{k_r}}=\dfrac{\partial^rf(x)}{\partial x_{i_1}\dots\partial x_{i_r}}~~\forall x\in D$.

### Доказательство:
Так как всякая перестановка раскладывается в композицию транспозиций, то достаточно рассмотреть одну транспозицию.
$(i_1,\dots,i_k,i_{k+1},\dots,i_r)\to(i_1,\dots,i_{k+1},i_k,\dots,i_r)$.
Заведём $\phi(s,t)=\dfrac{\partial^{k-1}f}{\partial x_{i_1}\dots\partial x_{i_{k-1}}}\Big(x_1,\dots,\overbrace{s}^{i_k},\dots,\overbrace{t}^{i_{k+1}},\dots,x_d\Big)$.
$r\ge k+1\Rarr\phi\in C^2(V_{(x_{i_k},x_{i_{k+1}})})\Rarr\phi''_{st},\phi''_{ts}\in C\Rarr$ по [теореме](23-04-24.md) получаем, что $\phi''_{st}=\phi''_{ts}~~\forall(s,t)\in V_{(x_{i_k},x_{i_{k+1}})}$.
Таким образом, $\dfrac{\partial^{k+1}f(x)}{\partial x_{i_1}\dots \partial x_{i_k}\partial x_{i_{k+1}}}=\dfrac{\partial^{k+1}f(x)}{\partial x_{i_1}\dots \partial x_{i_{k+1}}\partial x_{i_k}}$.
Осталось продифференцировать по оставшимся индексам $i_{k+2}\dots~~\scriptsize\blacksquare$

### Замечание.
$f\in C^r(D);~m\le r$
Тогда $\dfrac{\partial^m f}{\partial x_{i_1}\dots\partial x_{i_m}}=\dfrac{\partial^m f}{\partial x_1^{k_1}\dots\partial x_d^{k_d}},$ где $k_1+\dots+k_d=m$.

### Определение. Дифференциал $r$-ого порядка.
$f:D\sub\R^d\to\R;~r\in \N_0$.
$d^rf(x,h)=d\big(d^{r-1}f(x,h)\big)$
$d^0f(x,h)=f(x)$
$df(x,h)=(f'(x),h)=\displaystyle\sum_{k=1}^d\dfrac{\partial f}{\partial x_k}h_k$

Пусть $f\in C^2(D)$.
$d^2f(x,h)=d\big(df(x,h)\big)=\displaystyle\sum_{j=1}^d \dfrac{\partial \big(df(x,h)\big)}{\partial x_j}h_j=
\\
=\sum_{j=1}^d\dfrac{\partial\Big(\sum_{k=1}^d\dfrac{\partial f(x)}{\partial x_k} h_k\Big)}{\partial x_j}h_j=\sum_{j=1}^d\sum_{k=1}^d\dfrac{\partial^2 f}{\partial x_k\partial x_j}h_k h_j$

Пусть $f\in C^r(D)$.
$d^rf(x,h)=\displaystyle\sum_{k_1=1}^d\dots\sum_{k_r=1}^d\dfrac{\partial^r f(x)}{\partial x_{k_1} \dots \partial x_{k_r}}h_{k_1}\dots h_{k_r}$.

### Лемма $0$.
$r\in\N_0;~D~-~$открытое$;~f\in C^r(D);~x,h\in\R^d$.
$\overline{x,x+h}~-~$отрезок в $\R^d$ с концами $x$ и $x+h$.
Пусть $\overline{x, x+h}\sub D;~m\le r$.
$F(t):=f(x+th),$ где $t\in[0;1]$.
Тогда $F^{(m)}(t)=d^mf(x+th,h)$.

### Доказательство:
$m=0:~F^{(0)}(t)=F(t)=f(x+th)=d^0f(x+th,h)$
$m=1:~F'(t)=f'(x+th)\cdot h=d^1f(x+th,h)$
Индукционный переход: $m\mapsto m+1$.
$F^{(m)}(t)=\displaystyle\sum_{k_1=1}^d\dots\sum_{k_m=1}^d\dfrac{\partial^m f(x+th)}{\partial x_{k_1}\dots \partial x_{k_m}}h_{k_1}\dots h_{k_m}$.
$F^{(m+1)}(t)=\big(F^{(m)}(t)\big)'=\Big(\displaystyle\sum_{k_1=1}^d\dots\sum_{k_m=1}^d\dfrac{\partial^m f(x+th)}{\partial x_{k_1}\dots \partial x_{k_m}}h_{k_1}\dots h_{k_m}\Big)'=
\\
=\displaystyle\sum_{k_1=1}^d\dots\sum_{k_m=1}^d\Big(\sum_{k_{m+1}}^d\dfrac{\partial\Big(\dfrac{\partial^{m} f(x+th)}{\partial x_{k_1}\dots \partial x_{k_{m}}}\Big)(x+th)}{\partial x_{k_{m+1}}}h_{k_{m+1}}\Big)h_{k_1}\dots h_{k_m}=
\\
=\sum_{k_1=1}^d\dots\sum_{k_{m+1}=1}^d\dfrac{\partial^{m+1} f(x+th)}{\partial x_{k_1}\dots \partial x_{k_{m+1}}}h_{k_1}\dots h_{k_{m+1}~~\scriptsize\blacksquare}$

### Теорема. Формула Тейлора-Лагранжа (многомерная).
$D~-~$открытое$;~f:D\sub\R^d\to\R;~r\in\N_0;~f\in C^{r+1}(D);$
Пусть $\overline{x,x+h}\sub D$.
Тогда $f(x+h)=\displaystyle\sum_{k=0}^d\dfrac{d^kf(x,h)}{k!}+\dfrac{d^{r+1}f(x+\theta h)}{(r+1)!},$ где $\theta\in(0;1)$.

### Доказательство:
$F(t):=f(x+th)$.
Если $f\in C^{(r+1)},$ а $g(t)=x+th\in C^\infty$, то $F=f\circ g\in C^{r+1}\big([0;1]\big)$.
Разложим $F(t)$ в точке $t=0$ по формуле [Тейлора с остатком в форме Лагранжа](https://www.notion.so/60-10d641f35a50438587937e2d6a5a6da5?pvs=21) и подставим точку $t=1$.
$F(1)=\displaystyle\sum_{k=0}^d\dfrac{F^{(k)}(0)}{k!}(1-0)^k+\dfrac{F^{(r+1)}(\theta)}{(r+1)!}(1-0)^{(r+1)}$
$f(x+h)=F(1)$ и $F^{(k)}(0)=d^kf(x,h)$ по [Леммe 0](23-04-24.md)  $\scriptsize\blacksquare$