# 4. Канонический вид квадратичной формы. Теорема Лагранжа о приведении к каноническому
виду

## $\S3.$ Приведение квадратичной формы к диагональному (каноническому) виду.

### Определение. Канонический вид квадратичной формы.
Если $\exists$ базис $V:$ квадратичная форма $q$ в этом базисе имеет вид $q(x)=\lambda_1x_1^2+\lambda_2x_2^2+\ldots+\lambda_nx_n^2,$ то говорят, что квадратичная форма $q$ имеет канонический вид. 
При этом $\displaystyle A=\begin{pmatrix}
\lambda_1&0&\cdots&0
\\
0&\lambda_2&\cdots&0
\\
\vdots&\vdots&&\vdots
\\
0&0&\cdots&\lambda_n
\end{pmatrix}$, $rank(A)=$ количеству ненулевых $\lambda$.

### Теорема Лагранжа.
Любую квадратичную форму $q(x)$ можно привести к каноническому виду (то есть найдётся нужный базис).

### Доказательство:
Считаем, что $q(x)\ne0$, так как в противном случае доказательство тривиально, поскольку матрица уже диагональна.

$1.$ Предположим, что $a_{11}=...=a_{nn}=0$.
Поскольку $q(x)\ne0$, $\exist a_{ij}\ne0$. Сделаем замену:
$x_j=y_i+y_j;\quad x_i=y_i-y_j;\quad x_k=y_k~~(k\ne i$  и $k\ne j)$.
Тогда получим: $a_{ij}x_ix_j=a_{ij}(y_i-y_j)(y_i+y_j)=a_{ij}(y_i^2-y_j^2)$.

$2.$ Предположим, что $a_{11}=0$ и $\exist a_{ii}\ne0~~(i>1)$.
Сделаем замену:
$x_1=y_i;\quad x_i = y_1$
Тогда получим: $a_{ii}x_i^2 = a_{ii}y_1^2$

$3.$ По результатам $1.$ и $2.$ можем считать, что $a_{11}\ne0$.
Индукция по $n=\dim V$.
База $n=1$: $q(x)=a_{11}x^2~-~$матрица уже диагонализирована.
Индукционный переход: для $n-1$ теорема доказана. Докажем для $n$.
$\displaystyle q(x)=\sum_{i=1}^na_{ii}x_i^2+2\sum_{1\leq i<j\leq n}a_{ij}x_ix_j$.
Выделим слагаемые, содержащие в себе $x_1$:
$q(x)=a_{11}x_1^2+2a_{12}x_1x_2+...+2a_{1n}x_1x_n+($остальное$)=\\=a_{11}\Big(x_1^2+2\dfrac{a_{12}}{a_{11}}x_1x_2+...+2\dfrac{a_{1n}}{a_{11}}x_1x_n+$

$\quad\quad\quad+\Big(\dfrac{a_{12}}{a_{11}}\Big)^2 x_2^2+...+\Big(\dfrac{a_{1n}}{a_{11}}\Big)^2 x_n^2+2\displaystyle\sum_{2\le i<j\le n}\dfrac{a_{1i}\cdot a_{1j}}{a_{11}^2}x_ix_j\Big)-$

$-a_{11}\Big(\Big(\dfrac{a_{12}}{a_{11}}\Big)^2 x_2^2+...+\Big(\dfrac{a_{1n}}{a_{11}}\Big)^2 x_n^2+2\displaystyle\sum_{2\le i<j\le n}\dfrac{a_{1i}\cdot a_{1j}}{a_{11}^2}x_ix_j\Big)+\\$
$+($остальное$)=a_{11}\Big(x_1+\dfrac{a_{12}}{a_{11}}x_2+...+\dfrac{a_{1n}}{a_{11}}x_n\Big)^2+$

$+($квадратичная форма от $n-1$ слагаемых$)$.
Сделаем замену:
$y_1=x_1+\dfrac{a_{12}}{a_{11}}x_2+...+\dfrac{a_{1n}}{a_{11}}x_n;\quad y_i=x_i~~(i>1)$.
Тогда $q(x)=a_{11}y_1^2+($квадратичная форма от $y_2,...,y_n)$.
По предположению индукции получаем:
$q(x)=a_{11}z_1^2+\lambda_2z_2^2+...+\lambda_nz_n^2~~\scriptsize\blacksquare$

### Замечание.
Все преобразования соответствуют преобразованиям базиса.
Матрица преобразования невырожденная (определитель $\ne0)$.
$q(x)=X^TAX,$ где $X=\begin{pmatrix}
x_1
\\
\vdots
\\
x_n
\end{pmatrix}$, а $A~-~$матрица квадр. формы.
$X=CY,$ где $C~-~$матрица перехода от старого базиса к новому.
Тогда $C^TAC=\begin{pmatrix}
\lambda_1&0&\cdots&0
\\
0&\lambda_2&\cdots&0
\\
\vdots&\vdots&&\vdots
\\
0&0&\cdots&\lambda_n
\end{pmatrix}$.
При этом $f(e_i,e_j)=\begin{cases}
0, &i\ne j
\\
\lambda_i,&i=j
\end{cases}$