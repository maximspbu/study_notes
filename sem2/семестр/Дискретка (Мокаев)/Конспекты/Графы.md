---  
layout: mathjax  
---  
  
# Графы.  
  
### Орграф. Пути и циклы в графе.  
  
<aside>  
❗ Ориентированным графом, или орграфом, называют пару $G=(V,E)$, где $V\ne\varnothing$ является множеством вершин, а $E\subset V\times V~-~$множеством ребер.  
  
Ребра обычно записывают по их концам: $(u_1,u_2)$ или $u_1u_2$.  
  
Пустым графом называется граф, у которого $E=\varnothing$.  
  
$G'=(V',E')$ называется подграфом, если $V'\subset V$ и $E'\subset(V'\times V')\cap E$.  
  
Если $E'=(V'\times V')\cap E$, то подграф называется индуцированным, или порожденным, и обозначается $G[V']$.  
  
Путем наз-ся последовательность вершин $v_0v_1\dotsc v_n:v_{i-1}v_i\in E ~~ \forall i\in\{ 1:n \}$.  
  
Путь называется простым, если все вершины в нём различны.  
  
Циклом наз-ся последовательность вершин $v_0v_1\dotsc v_n:v_{i-1}v_i\in E ~~ \forall i\in\{ 1:n \}$ и при том $v_0=v_n$.  
  
Цикл называется простым, если все вершины (кроме крайних) различны.  
  
Ациклический граф $-$ граф без циклов.  
  
</aside>  
  
### Отношение достижимости.  
  
На множестве вершин $V$ зададим отношение достижимости $R^*$:  
$(v_1,v_2)\in R^{ * }\Leftrightarrow$ вершина $v_2$ достижима из $v_1$, то есть существует путь с началом в $v_1$ и концом в $v_2$.  
  
Как и в случае с марковскими цепями, отношение взаимной достижимости является отношением эквивалентности. Оно также разобьёт множество вершин графа на классы эквивалентности.  
  
Рассмотрим вершины $v_1,v_2$, принадлежащие одному классу эквивалентности. По определению у нас будут существовать пути: $l_1=v_1\dotsc v_2$ и $l_2=v_2\dotsc v_1$. Тогда вмести эти $2$ путя образуют цикл $\Rightarrow$ все вершины класса эквивалентности принадлежат некоторому циклу.  
  
Из этого можно сделать вывод: если граф ацикличен, то классы эквивалентности состоят из $1$ вершины.  
  
### Граф покрытие и граф достижимости.  
  
<aside>  
❗ Базисным графом для графа $G$ называется минимальный граф $G_b$ (имеющий наименьшее число ребер), такой что он индуцирует на $V(G)$ то же отношение достижимости, что и $G$.  
  
</aside>  
  
В конечном орграфе есть базисный граф. Он получается удалением ребер $v_1v_2$, таких что существует путь между $v_1$ и $v_2$, не содержащий ребро $v_1v_2$.  
  
<aside>  
❗ В неорграфах классы эквивалентности по отношению достижимости называют компонентами связности.  
  
В орграфах классы эквивалентности по отношению взаимной достижимости называют компонентами сильной связности.  
  
Графом достижимости графа $G$ называется граф $G^*=(V,E^*)$, где ребра берутся следующим образом: $E^*=\{ uv~|~(u,v)\in R^* \}$.  
  
</aside>  
  
Таким образом, ребра $G^*$ замещают собой пути в графе $G$.  
  
### Построение графа достижимости.  
  
<aside>  
❗ Матрицей смежности орграфа $G$ c $|V|=n$ называется матрица $A_G\in M_n$ с элементами:  
  
$$  
A_{ij}=\begin{cases}  
1,&\text{если }(v_i,v_j)\in E  
\\  
0,&\text{в противном случае}  
\end{cases}  
$$  
  
</aside>  
  
Введем обозначения:  
$$\tilde{A}:=A_G\lor E_n;\quad \tilde{A}_0=E_n;\quad \tilde{A}_1=\tilde{A};\quad\dotsc\quad;\quad \tilde{A}_{k+1}=\tilde{A}_k\land \tilde{A}$$.  
  
<aside>  
❓ Пусть $\tilde{A}_k=(a_{ij}^{(k)})$ $\Rightarrow a_{ij}^{(k)}=\begin{cases}  
1,&\text{в }G\text{ существует путь из }v_i\text{ в }v_j\text{ длины}\le k  
\\  
0,&\text{в противном случае}  
\end{cases}$  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Докажем по индукции.  
  
База $k=0$ верна по определению $\tilde{A}_0$.  
  
Индукционный переход $k\mapsto k+1$.  
$a_{ij}^{(k+1)}=a_{i1}^{(k)} a_{1j}^{(1)}\lor\dotsc\lor a_{in}^{(k)}a_{nj}^{(1)}$.  
  
По сути нужно доказать, что $a_{ij}^{(k+1)}=1\Leftrightarrow$ существование пути.  
  
$\Leftarrow:$  
Предположим, что существует путь из $v_i$ в $v_j$ длины $\le k+1$.  
Рассмотрим кратчайший такой путь. Если его длина $\le k$, то $a_{ij}^{(k)}=1$ и $a_{jj}^{(1)}=1$.  
Если же его длина $= k+1$,  то рассмотрим предпоследнюю вершину $r$ в пути.  
Понятно, что $a_{ir}^{(k)}=1$ и $a_{rj}^{(1)}=1\Rightarrow a_{ij}^{(k+1)}=1$.  
  
$\Rightarrow:$  
Так как $a_{ij}^{(k+1)}=1$, то $\exists r: a_{ir}^{(k)}a_{rj}^{(1)}=1$.  
Тогда есть $2$ пути: до промежуточной вершины длины не более $k$ и от промежуточной вершины длины не более $1$. Объединяем их и получаем то, что нужно.  
  
</aside>  
  
Отсюда следует, что $$\tilde{A}_{n-1}=A_{G^{ * }}$$. Тогда граф достижимости можно построить по $$A_{G^{ * }}$$.  
  
### Граф сильной достижимости и конденсация.  
  
<aside>  
❗ Графом сильной достижимости называют граф $G_*^*=(V,E_*^*)$, в котором ребря выбираются следующим образом: $E_*^*=\{ uv~|~u\Leftrightarrow v\text{ в }G\}$.  
  
</aside>  
  
Матрицу графа сильной достижимости можно построить по матрице графа достижимости следующим образом: $A_{G_*^{ * }}(i,j)=A_{G^{ * }}(i,j)\land A_{G^{ * }}(j,i)$.  
  
<aside>  
⚙ По матрице сильной достижимости можно выделить компоненты сильной связности.  
  
- В первую компоненту помещаем $v_1$ и все $v_j:A_{G_*^*}(1,j)=1$.  
- Пусть построена $i$-тая компонента. Возьмём $v_k$, который не принадлежит ни одной компоненте связности, и строим $i+1$ компоненту связности, помещая в нее $v_k$ и $v_j:A_{G_*^*}(k,j)=1$.  
</aside>  
  
<aside>  
❗ Пусть $K_1,K_2~-~$компоненты связности графа $G$.  
  
Компонента $K_2$ достижима из $K_1$, если $K_1=K_2$ или $\exists u\in K_1, v\in K_2:u\to v$.  
  
Компонента $K_2$ строго достижима из $K_1$, если она достижима и $K_1\ne K_2$.  
  
Отношение строгой достижимости  на компонентах связности можно представлять в виде орграфа, который будет называться конденсацией $G$ и будет ацикличным графом (иначе взаимнодостижимые компоненты объединятся в одну).  
  
</aside>  
  
### Турниры и полустепени в орграфе.  
  
<aside>  
❗ Полустепень исхода $d^+(v)$ вершины $v$ $-$ число ребер, исходящих из вершины $v$.  
  
Полустепень захода $d^-(v)$ вершины $v~-~$число ребер, входящих в вершину $v$.  
  
Турниром называют полный орграф (между любыми $2$ вершинами есть ребро).  
  
Если $(u,v)\in E$, то говорим, что $u$ доминирует над $v$.  
  
Турнир транзитивен, если $(x,y)\in E$ и $(y,z)\in E\Rightarrow (x,z)\in E$.  
  
Порядком турнира $T$ называют кол-во его вершин.  
  
Полустепень исхода вершины $v$ $-$ кол-во вершин, над которыми доминирует $v$ (также называется результатом).  
  
Последовательность результатов$~-~$упорядоченная последовательность $(s_i)_{i=1}^n$, где $s_i~-~$результат $v_i$. При этом $s_1\le s_2\le \dotsc \le s_n$.  
  
Множество результатов $-$ последовательность $(d_i)_{i=1}^m$ различных результатов вершин турнира $T$. При этом $d_1<d_2<\dotsc<d_m$.  
  
Если турнир $T$ имеет последовательность результатов $S$ и множество результатов $D$, то говорим, что $S$ генерирует $D$.  
  
</aside>  
  
### Теорема Редеи-Камеона для пути.  
  
<aside>  
❓ Любой турнир $T$ порядка $n$ содержит гамильтонов путь (простой путь состоящий из $n$ вершин).  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Докажем индукцией по $n$. База $n=2$ очевидна.  
  
Индукционный переход $n\mapsto n+1$.  
Возьмём произвольную вершину $v^*$ и исключим её из турнира. Останется $n$ вершин, а значит по предположению есть простой путь длины $n:P=(v_1,\dotsc,v_n)$.  
  
Рассмотрим $2$ случая:  
  
$1)$ $\exists (v^*,v_i)\in E$, где $i=\min$.  
В этом случае $(v_{i-1},v^*)\in E\Rightarrow$ есть путь $P_0=(v_1,\dotsc,v_{i-1},v^*,v_i,\dotsc,v_n)$.  
Если же $i=1$, то все еще проще: $P_0=(v^*,v_1,\dotsc,v_n)$.  
  
$2)~\forall i\in\{ 1:n \} ~~ (v_i,v^*)\in E$  
Тогда $(v_n,v^*)\in E\Rightarrow$ существует путь $P_0=(v_1,\dotsc,v_n,v^*)$.  
  
</aside>  
  
### Теорема Редеи-Камеона для цикла.  
  
<aside>  
❗ Турнир является сильно связным, если из любой вершины существует путь до любой другой.  
  
</aside>  
  
<aside>  
❓ Сильно связный турнир $T$ порядка $\ge3$ содержит цикл длины $3$.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Рассмотрим произвольную вершину $v^*$ и обозначим за $V_1,V_2$ множества вершин доминирующих над $v^*$ и доминируемых $v^*$ соответственно.  
  
Заметим, что $V_1\cap V_2=\varnothing$, так как $v^*$ не может одновременно доминировать над вершиной и быть доминируемой этой вершиной. Также $V_1,V_2\ne\varnothing$, так как в противном случае $v^*$ будет истоком или стоком, что противоречит сильной связности (не будет пути в $v^*$ либо из $v^*$).  
  
Если не существует ребра $v_2v_1:v_1\in V_1, v_2\in V_2$, то вершины $V_1$ недостижимы из вершин $V_2$, что противоречит сильной связности. Значит такие $v_1,v_2$ существуют, и тогда есть цикл длины $3:v_1v^*v_2v_1$.  
  
</aside>  
  
<aside>  
❓ Если сильносвязный турнир порядка $\ge 3$ имеет цикл длины $k$, то он имеет цикл длины $k+1$.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Обозначим цикл длины $k:C_k=(v_1,\dotsc,v_k,v_1)$.  
  
Рассмотрим $2$ случая:  
  
$1)$ $\exists v^*:\exists v_i,v_j\in C_k:(v_i,v^*)\in E$ и $(v^*,v_j)\in E$.  
В этом случае перенумеруем вершины так, чтобы $(v_1,v^*)\in E$. Теперь найдём первую вершину $v_i:(v^*,v_i)\in E\Rightarrow (v_{i-1},v^*)\in E$.  
Получили цикл длины $k+1:(v_1,\dotsc, v_{i-1},v^*,v_i,\dotsc,v_k,v_1)$.  
  
$2)$ Такой $v^*$ не существует.  
В этом случае поделим оставшиеся вершины на доминируемые $C_k$ и доминирующие $C_k$. По сильной связности эти множества не могут быть пусты, обозначим их $V_1,V_2$ соответственно. По этому же условию есть ребро $wu:u\in V_1, w\in V_2$.  
Тогда получили цикл длины $k+1:(v_1,w,u,v_3,\dotsc,v_k,v_1)$.  
  
</aside>  
  
<aside>  
❓ В сильно связном турнире есть гамильтонов цикл (верно и обратное).  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Доказываем по индукции кол-ва вершин в цикле.  
  
База и переход следуют из лемм выше.  
  
</aside>  
  
### Король турнира.  
  
<aside>  
❗ Вершина $v$ называется королём турнира $\Leftrightarrow$ $\forall x\in T ~~ \exists$ путь из $u$ в $x$ длины $\le 2$.  
  
</aside>  
  
<aside>  
❓ В любом турнире есть король.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Рассмотрим вершину $v:d^+(v)=\max$. Покажем, что это король.  
  
Предположим противное. Пусть $v~-~$не король. Снова разобъем оставшиеся вершины на доминирующие $v~(V_1)$ и доминируемые $v~(V_2)$.  
  
Из того, что $v$ не является королем, следует $\exists x\in T:\forall$ путь из $v$ в $x$ будет длины $>2$. Тогда $x\in V_1$, так как до вершин из $V_2$ можно добраться за $1$ шаг. При этом нет вершины $u\in V_2:(u,x)\in E$, так как иначе есть путь длины $2$.  
  
Отсюда делаем вывод, что $x~-~$доминирует все вершины $V_2$ и $v$, а это значит $d^+(x)>d(v)$, что противоречит выбору $v$.  
  
</aside>  
  
### Эквивалентность свойств турнира.  
  
<aside>  
❓ Для турнира порядка $n$ следующие свойства эквивалентны:  
  
1. $T$ транзитивен.  
2. $T$ не содержит циклов длины $3$.  
3. $T$ ацикличен.  
4. Последовательность результатов $S=(0,1,2\dotsc,n-1)$  
5. $T$ содержит ровно один Гамильтонов путь.  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> $1)\Rightarrow2):$  
$(x,y)\in E$, $(y,z)\in E$ и $(x,z)\in E\Rightarrow (z,x)\notin E$.  
  
$2)\Rightarrow 3):$  
Так как нет циклов длины $3$, то $\forall x,y,z:(x,y)\in E$ и $(y,z)\in E\Rightarrow (x,z)\in E$, а это транзитивность. Тогда для любого цикла $C_k=(v_1,\dotsc,v_k,v_1)$, где $k\ge 4$, верно, что $(v_1,v_k)\in E$ и $(v_k,v_1)\in E\Rightarrow$ получили противоречие.  
  
$3)\Rightarrow 4):$  
Рассмотрим $D^+(T)~-~$множество степеней исхода (результатов).  
Докажем индукцией по кол-ву вершин в турнире. База $n=1$ очевидна.  
  
Индукционный переход $n-1\mapsto n$.  
Так как в ациклическом графе есть вершина сток $t$, то $d^+(t)=0$.  
Рассмотрим теперь граф без этой вершины. По предположению индукции множество результатов $S=\{ 0,1,\dotsc,n-2 \}$. В исходном графе из каждой вершины есть ребро в $t\Rightarrow$ $D^+(T)=\{ 0,1,\dotsc,n-1 \}$.  
  
$4)\Rightarrow 5):$  
Существование есть по теореме Редеи-Камеона. Докажем единственность.  
Снова докажем индукцией по числу вершин. База $n=1$ очевидна.  
  
Индукционный переход $n\mapsto n+1$.  
Возьмём вершину-исток $s:d^-(s)=0$.  
Рассмотрим граф без этой вершины. Все степени входа уменьшаться на $1$, и тогда по предположению индукции есть единственный гамильтонов путь. Добавим нашу вершину обратно, она будет доминировать над всем другими, и тогда гамильтонов путь нужный длины получен, и он также будет единственным.  
  
$5)\Rightarrow 1):$  
Пусть $P=(v_1,\dotsc,v_n)~-~!$ гамильтонов путь, а $m~-~$минимальный индекс, такой что в $v_m$ идет ребро из вершины с большим индексом. Обозначим $v_k~-~$вершина с максимальным индексом, такая что $(v_k,v_m)\in E$.  
  
Рассматриваем $4$ случая:  
  
- $m\ne1,k\ne n:$  
  
Из минимальности $m:(v_{m-1},v_{m+1})\in E$, а из максимальности $k:(v_m,v_{k+1})\in E$.  
Тогда есть еще один путь $P=(v_1,\dotsc,v_{m-1},v_{m+1},\dotsc,v_k,v_m,v_{k+1},\dotsc,v_n)$.  
  
- $m\ne 1, k=n:$  
  
$P=(v_1,\dotsc,v_{m-1},v_{m+1},\dotsc,v_n,v_m)$  
  
- $m=1,k\ne n:$  
  
$P=(v_2,\dotsc,v_{k},v_1,v_{k+1},\dotsc,v_n)$  
  
- $m=1,k=n:$  
  
$P=(v_2,\dotsc,v_n,v_1)$  
  
Значит такого $m$ не существует и при этом $(v_i,v_j)\in E\Rightarrow i<j$.  
Тогда $\forall i,j,k ~~ (v_i,v_j)\in E$ и $(v_j,v_k)\in E\Rightarrow i< j$ и $j<k\Rightarrow i<k$, а значит $(v_i,v_k)\in E$.  
  
</aside>  
  
<aside>  
❓ Конденсация любого турнира является транзитивным турниром.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Конденсация турнира будет турниром. Так как конденсация ациклична, то по теореме выше, она будет транзитивна.  
  
</aside>  
  
### Теорема Ландау.  
  
<aside>  
❓ Неубывающая последовательность целых чисел $S=(s_1,\dotsc,s_n)$ является последователностью результатов некоторого турнира тогда и только тогда, когда выполняется неравенство:  
  
$$  
\sum_{i=1}^k s_i\ge \dfrac{k(k-1)}2 ~~ \forall k\in \\{ 1:n \\}  
$$  
  
</aside>  
  
### Дерево и лес.  
  
<aside>  
❗ Связный граф без циклов называется деревом.  
  
Произвольный граф без циклов называется лесом.  
  
</aside>  
  
<aside>  
❓ Следующие определения эквивалентны:  
  
1. $G~-~$дерево.  
2. $G~-~$граф$~:\forall v_1,v_2\in V ~~ \exists!$ простой путь между ними.  
3. $G~-~$связный граф, в котором $|V|=|E|+1$.  
4. $G~-~$граф без циклов, в котором $|V|=|E|+1$.  
5. $G~-~$граф без циклов, в котором при добавлении ребра между несмежными вершинами образуется один простой цикл.  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> $1)\Rightarrow2):$  
Связность говорит о том, что между любыми $2$ вершинами есть путь. Он будет единственным, так как иначе образуется цикл. Он будет простым, иначе посещаем $1$ вершину несколько раз, а значит образуется цикл.  
  
$2)\Rightarrow3):$  
Так как между любыми двумя точками есть путь, получаем связность графа.  
  
Докажем равенство индукцией по кол-ву вершин в графе. База $n=2$ очевидна.  
  
Индукционный переход $n-1\mapsto n$.  
Удалим одно ребро, и нарушится связность, так как между двумя вершинами существует единственный путь. Тогда образуется $2$ компоненты связности с $k$ и $n-k$ вершинами.  
  
Для этих компонент связности выполняется предположение индукции, тогда в исходном графе есть $(k-1)+(n-k-1)+1=n-1$ ребро.  
  
$3)\Rightarrow 4):$  
Начнем добавлять ребра в граф по $1$-му. Если в какой-то момент образовался цикл, то в нем кол-во вершин и ребер будет равно, а значит в итоге не удастся присоединить какую-то вершину к графу, что будет противоречить связности.  
  
$4)\Rightarrow 5):$  
Пусть в графе есть $k$ компонент связности. Это связные и ацикличные (по условию) графы, а значит деревья. Тогда для каждой компоненты верно: $|V_i|=|E_i|+1$.  
  
Складываем по всем компонентам и получаем: $|V|=|E|+k$, но для нашего графа выполняется равенство $|V|=|E|+1\Rightarrow$ есть всего одна компонента связности и весь наш граф $-$ дерево, а значит между любыми $2$ вершинами есть единственный простой путь $\Rightarrow$ при добавлении ребра возникнет простой цикл.  
  
$5)\Rightarrow1):$  
Если добавить ребро между $u,v$ то образуется простой цикл $\Rightarrow$ уже существует путь между этими вершинами, а значит получаем связность.  
  
</aside>  
  
### Остовные деревья.  
  
<aside>  
❗ Подграф $H\le G$ называют остовом, если $V(H)=V(G)$.  
  
</aside>  
  
<aside>  
❓ У каждого графа существует остовный лес (у связного $-$ дерево).  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Докажем для связного графа, так как для несвязного можно рассмотреть компоненты связности.  
  
Пока в графе есть циклы, удаляем из цикла ребро. Граф останется связным.  
  
</aside>  
  
<aside>  
🤔 Можно ли связать существование остовного леса (дерева) с существованием базисного графа?  
  
</aside>  
  
### Минимальное остовное дерево. Лемма о безопасном ребре.  
  
<aside>  
❗ $w:E(G)\to R_+~-~$веса ребер.  
  
Весом графа называется $w_G=\displaystyle\sum_{e\in E}w(e)$.  
  
Минимальным оставным деревом наз-ся остовное дерево с минимальным весом.  
  
</aside>  
  
<aside>  
❓ Пусть $\Upsilon~-~$множество всех минимальных остовных деревьев связного графа $G$.  
  
Возьмём $T\in\Upsilon~-~$некоторое минимальное остовное дерево.  
$X\subset E(T)~-~$подмножество ребер этого МОД-а.  
  
Пусть $\langle S, V(G)\setminus S\rangle~-~$разрез графа $G$.  
$Q=\{ uv~|~u\in S, v\in V(G)\setminus S \}~-~$множество ребер, пересекающих разрез.  
При этом разрез взят так, что $Q\cap X=\varnothing$.  
  
Выберем $e\in Q:w(e)=\displaystyle\min_{q\in Q}w(q)$. Тогда $\exists T'\in\Upsilon:X\cup\{ e \}\subset E(T')$.  
  
</aside>  
  
Эта лемма необходима для алгоритмов Краскала и Прима-Ярника, с помощью которых мы и будем строить минимальное остовное дерево. Она помогает понять, как добавить ребро с минимальным весом, чтобы не образовать цикл или соединить разные компоненты связности.  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Если $e\in E(T)$, то $X\cup\{ e \}\subset E(T)\Rightarrow T=T'$.  
  
Рассмотрим случай, когда $e\notin E(T)$.  
  
Пусть $e=(u,v)$. Возьмём путь из $u$ в $v$, лежащий в $T$ (он есть, так как $T~-~$дерево). Так как $u\in S$ и $v\in V(G)\setminus S$, то $\exists e'\in E(T)$ и $e'\in Q~-~$вершина в пути.  
По выбору $e$ понимаем, что $w(e)\le w(e')$. Тогда заменим ребро $e'$ на ребро $e$. Связность сохранится, циклов не добавится, а значит мы получили новое остовное дерево, которое будет минимальным.  
  
</aside>  
  
<aside>  
❗ Ребро $e$ называется безопасным ребром.  
  
</aside>  
  
### Алгоритм Краскала.  
  
<aside>  
📺 Видеоролик с примером и объяснением.  
  
https://www.youtube.com/watch?v=KDKACf8tcnM&list=PLA0M1Bcd0w8yF0PO0eJ9v8VlsYEowmsnJ&index=6  
  
</aside>  
  
<aside>  
⚙ Итеративно строим $F\le G$. На каждом шаге достраиваем $F$ до МОД.  
  
Добавим все вершины $G$ в $F$, то есть сделаем $V(G)=V(F)$.  
  
Далее начинаем обходить ребра в порядке неубывания весов:  
  
1. Если $e$ соединяет вершины из одной компоненты связности, то добавление ребра приведет к образования цикла. Не добавляем $e$.  
2. Если $e$ соединяет вершины из разных компонент связности, то есть разрез, в котором одна компонента является $S$, а оставшаяся часть графа $-$ дополнением. Тогда по лемме $e~-~$безопасное ребро. Добавляем его в $F$.  
  
На последнем шаге ребро соединит $2$ оставшиеся компоненты связности и мы получим МОД.  
  
</aside>  
  
### Алгоритм Прима-Ярника.  
  
<aside>  
📺 Видеоролик с примером и объяснением.  
  
https://www.youtube.com/watch?v=_SLQMpLzcUE  
  
</aside>  
  
<aside>  
⚙ Итеративно строим $F\le G.$  
  
Храним приоритетную очередь $Q$ вершин $v$ из вершин $G\setminus F$.  
  
Они будут отсортированы по следующему ключу:  
 $\displaystyle\min_{u\in V(F),~uv\in E(G)}w(uv)~-~$вес минимального ребра из $v$ в вершину $F$.  
  
Также для каждой вершины будет храниться вершина, на которой достигается значение ключа, то есть $p(v)=u$.  
  
1. Все ключи $=+\infty$. $Q=V(F)$  
2. Выбирается произвольная вершина $r$. Её ключ обнуляется, а ключи смежных вершин обновляются расстоянием до них.  
3. Пока $Q$ не пусто, извлекаем минимальную по ключу вершину $v$ из $Q$.  
Проходимся по смежным вершинам $u$ и, если $u\in Q$ и ключ $>w(vu)$, обновляем вершину $u$: $p(u)=v$ и ключ $=w(vu)$.  
В $F$ добавляем ребро $\big(v,p(v)\big)$  
</aside>  
  
### Дерево кратчайших путей на взвешенном графе.  
  
Пусть дан взвешенный граф $G=(V,E)$ с функцией веса $w:E\to \mathbb{R}_+$, и зафиксирована вершина $s$. Требуется найти кратчайшие пути до остальных вершин.  
  
<aside>  
❗ Получающийся подграф кратчайших путей (в случае связного графа) будет деревом. Оно называется деревом кратчайших путей.  
  
</aside>  
  
### Алгоритм Дейкстры.  
  
<aside>  
⚙ Храним список предков для каждой вершины. Обозначим его $p$.  
  
1. Инициализируем список кратчайших расстояний $d[V]$. У всех вершин, кроме $s$ значения равны $+\infty$; у $s~-~0$.  
2. В списке непосещенных вершин выбирается вершина $v$ с кратчайшим расстоянием до $s$ и помечается как посещенная. Если кратчайшее расстояние $=+\infty$, то алгоритм можно останавливать.  
3. Смотрим смежные с $v$ вершины $u$. Если расстояние $d[u]>d[v]+w(uv)$, то обновляем значение $d[u]$ и записываем $p[u]=v$.  
4. Идем в пункт $2.$  
  
Кратчайший путь от $s$ до $v$ будет $(s,\dotsc,p[p[v]],p[v],v)$, а дерево кратчайших путей строится по списку предков: $E_d=\{ uv~|u=p[v],v\in V(G) \}$.  
  
</aside>  
  
### Необходимые обозначения для введения сетей.  
  
Пусть дан граф $G=(V,E)$.  
  
$\forall e=xy\in E(G)$ определим $\overrightarrow{e}=(e,x,y)$ и $\overleftarrow e=(e,y,x)$.  
$\overrightarrow{E}:=\{ (e,x,y)~|~e=xy;~x,y\in V(G);~e\in E(G) \}~-~$сюда входят ребра обеих направленностей, то есть $|\overrightarrow{E}|=2|E|$.  
  
Для $X,Y\subset V(G)$ определим $\overrightarrow{E}(X,Y):=\\{ (e,x,y)~\|~x\in X,y\in Y,(e,x,y)\in \overrightarrow{E } \\}$.  
  
Для произвольной функции $f:E\to\mathbb{R}$ и $X,Y\in V(G)$ определим образ:  
  
$$  
  
⁍  
$$  
  
### Сеть и поток.  
  
<aside>  
❗ Пусть дан неорграф $G=(V,E)$.  
  
Вершины $s,t$ назовем истоком и стоком соответственно, если любая другая вершина лежит на пути из $s$ в $t$.  
  
Функция $c:\overrightarrow{E}\to \mathbb{N}_0$ на $G~-~$пропускные способности ребёр.  
  
$(G,s,t,c)~-~$сеть.  
  
Функция $f:\overrightarrow{E}\to\mathbb{R}~-~$поток в сети, если выполняются свойства:  
  
1. $\forall e\in E(G) ~~ f(\overrightarrow{e})=-f(\overleftarrow{e})~-~$антисимметричность.  
2. $\forall t\ne v\ne s\in V(G)  ~~ f\big(\{ v \},V(G)\big)=0~-~$закон сохранения потока.  
3. $\forall\overrightarrow{e}\in\overrightarrow{E} ~~ f(\overrightarrow{e})\le c(\overrightarrow{e})~-~$ограничение пропускной способности.  
  
Разрезом, или $(s,t)$-разрезом, в сети $(G,s,t,c)$ называют пару $(S,\overline{S})$, такую что $S\subset V(G),$ а $\overline{S}=V(G)\setminus S$. При этом $s\in S$, $t\in \overline{S}$.  
  
$f\big(\{ s \},V(G)\big)=:|f|~-~$величина потока в сети.  
  
$с(S,\overline{S}):=\displaystyle\sum_{\overrightarrow{e}\in \overrightarrow{E}(S,\overline{S})}c(\overrightarrow{e})~-~$пропускная способность разреза.  
  
</aside>  
  
<aside>  
❓ $(S,\overline{S})~-~$разрез в $G\Rightarrow f(S,\overline{S})=|f|$.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Распишем $f(S,\overline{S})$ используя определения:  
  
$$  
f(S,\overline{S})=f\big(S,V(G)\big)-f(S,S)=  
\\=f\big(\{ s \},V(G)\big)+f\big(S\setminus\{ s \},V(G)\big)-f(S,S)  
$$  
  
Второе слагаемое обнулится по второму свойству, а третье по первому.  
Останется $f(\{ s \},V)=|f|$.  
  
</aside>  
  
<aside>  
❓ $(S,\overline{S})~-~$разрез в $G\Rightarrow |f|\le c(S,\overline{S})$  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> $|f|=f(S,\overline{S})=\displaystyle\sum_{\overrightarrow{e}\in\overrightarrow{E} }f(\overrightarrow{e})\le \sum_{\overrightarrow{e}\in\overrightarrow{E} }c(\overrightarrow{e})=c(S,\overline{S})$.  
  
</aside>  
  
### Теорема Форда-Фалкерсона.  
  
<aside>  
❓ Пусть в сети только целые пропускные способности. Тогда величина максимального потока равна пропускной способности минимального разреза.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> По леммам выше мы знаем, что $\forall f$ верно $|f|\le c(S,\overline{S})$.  
Определим нулевой поток $f_0$ (поток на всех ребрах равен нулю).  
  
Рассмотрим итеративную процедуру:  
$f_n~-~$целочисленный поток.  
  
$S_n=\{ u\in V(G)~|~(s=v_0,\dotsc,v_k=u ~-~$простой путь, $(e_i,v_i,v_{i+1})\in \overrightarrow{E}\}$  
Для путей, по которым выбираем $u$, еще накладывается условие $c(\overrightarrow{e_i})-f_n(\overrightarrow{e_i})>0$.  
  
$1)$ $t\in S_n$, то есть сток находится в $S_n$.  
Тогда по построению есть простой путь $(s=v_0,\dotsc,v_k=t)$ из истока в сток.  
  
Обозначим $\varepsilon=\displaystyle\min_{i\in\{ 0:(k-1) \} }\big(c(\overrightarrow{e_i})-f_n(\overrightarrow{e_i})\big)$ и определим $f_{n+1}$:  
  
- $f_{n+1}(\overrightarrow{e})=f_{n}(\overrightarrow{e})+\varepsilon,$ если $\exists j:\overrightarrow{e}=\overrightarrow{e_j}$  
- $f_{n+1}(\overrightarrow{e})=f_{n}(\overrightarrow{e})-\varepsilon,$ если $\exists j:\overrightarrow{e}=\overleftarrow{e_j}$  
- $f_{n+1}(\overrightarrow{e})=f_{n}(\overrightarrow{e})$, в ином случае.  
  
По определению $f_{n+1}$ тоже поток, но $|f_{n+1}|=|f_n|+\varepsilon$. Поток ограничен сверху, а значит алгоритм сделает конечное кол-во шагов.  
  
$2)~t\notin S_n$.  
В этом случае $(S_n,\overline{S_n})~-~$разрез.  
Тогда $\forall\overrightarrow{e}\in\overrightarrow{E}(S_n,\overline{S_n}) ~~ f_n(\overrightarrow{e})=c(\overrightarrow{e})\Rightarrow c(S_n,\overline{S_n})=f_n(S_n,\overline{S_n})=|f_n|$.  
  
</aside>  
  
### Непересекающиеся пути.  
  
Пусть $G=(V,E)~-~$связный граф, а $v,w~-~$несмежные вершины.  
  
<aside>  
❗ Пути из $v$ в $w$ называются реберно-непересекающимися, если у них нет общих ребер.  
  
Пути из $v$ в $w$ вершинное-непересекающиеся, если никакие два из них не имеют общих вершин, кроме $v$ и $w$.  
  
</aside>  
  
### Разделители.  
  
<aside>  
❗ $v,w$-разделяющим множеством графа $G$ будем называть множество ребер $\overline{E}$, такое что каждый путь между $v$ и $w$ содержит ребро из $\overline E$.  
  
$v,w$-отделяющим множеством графа $G$ является множество вершин $S$, отличных от $v$ и $w$, таких, что каждый путь проходит через вершину $S$.  
  
Альтернативное определение:  
  
Множество $S$ ребер/вершин разделяет/отделяет две вершины $v$ и $w$, если они принадлежат разным компонентам связности $G\setminus S$.  
  
</aside>  
  
<aside>  
🔑 Пример разделителей.  
  
![Untitled](/sem2/семестр/Дискретка (Мокаев)/Конспекты/Графы/Untitled.png)  
  
</aside>  
  
### Реберная теорема Менгера.  
  
<aside>  
❗ Ребро $e\in E$ называется инцидентным вершине $v$, если $e=vx$ или $e=xv$, где $x$ произвольная смежная $v$ вершина.  
  
</aside>  
  
<aside>  
❓ Максимальное количество реберно-непересекающихся путей, соединяющиях две различные вершины $v,w$ связного графа, равно минимальному числу ребер в $v,w$-разделяющем множестве.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Возьмём минимальное $v,w$-разделяющее множество. Тогда количество реберно-непересекающихся путей не может превышать мощности этого разделяющего множества, иначе получается, что одно из ребер разделяющего множества попадает в $2$ путя.  
  
Равенство докажем индукцией по кол-ву ребер в графе. База $|E(G)|=1$ очевидна.  
  
Индукционный переход $|E(G)|=m-1\mapsto m$.  
  
$1)$ Пусть $\exists v,w$-разделяющее множество $\overline{E}$ минимального размера $k$, такое что есть ребра не инцидентные $v$ и не инцидентные $w$ одновременно.  
  
Удалим из $G$ ребра $\overline{E}$, и останется два непересекающихся подграфа $V$ и $W$, содержащих вершины $v$ и $w$ соответственно.  
  
Теперь построим графы $G_1$ и $G_2$ из графа $G$:  
$G_1$ получается [стягиванием ребер](//ru.wikipedia.org/wiki/Стягивание_ребра) $V$ до вершины $v$, то есть мы берем вершины из множества $V$ и соединяем с $v$, удаляя связывающие их ребра. Аналогично поступаем с $W$ и $G_2$.  
  
<aside>  
🔑 На примере графа выше с $\overline{E}=E_1$.  
  
![Untitled](/sem2/семестр/Дискретка (Мокаев)/Конспекты/Графы/Untitled 1.png)  
  
</aside>  
  
Ребер в $G_1$ и $G_2$ меньше, чем в $G$. При этом $\overline{E}$ является минимальным $v,w$-разделяющим множеством (с учётом отождествленияя вершин в рез-те склейки).  
  
Эти графы удовлетворяют предположению индукции, а значит в каждом из них есть $k$ реберно-непересекающихся путей от $v$ до $w$. Стыкуем пути в $G_1$ и $G_2$ и получаем нужные $k$ путей.  
  
$2)$ Теперь рассмотрим $v,w$-разделяющее множество $\overline{E}$ минимального размера $k$, такое что все его ребра инцидентны $v$, либо инцидентны $w$.  
  
Если есть ребра, не принадлежащие некоторому $v,w$-разделяющему множеству размера $k$, то мы можем удалить это ребро (тогда размер минимального $v,w$-разделяющего множества не изменится) и воспользоваться предположением индукции.  
  
Пусть каждое ребро принадлежит какому-то $v,w$-разделяющему множеству длины $k$.  
Рассмотрим произвольный путь $P$ между $v$ и $w$. Так как каждая вершина принадлежит некоторому $v,w$-разделяющему множеству, а ребра этого множества инцидентны $v$, либо $w$, то $P$ состоит из одного или двух ребер $\Rightarrow$ этот путь будет содержать не более одного ребра (из-за минимальности, так как брать оба ребра нет смысла) из любого $v,w$-разделяющего множества длины $k$.  
  
Удалим ребра $P$ из графа и получим, что размер минимального $v,w$-разделяющего множества уменьшился на единицу и стал равен $k-1$. Тогда по предположению индукции у нас есть $k-1$ реберно-непересекающийся путь. Добавим обратно $P$ и получим $k$ путей.  
  
</aside>  
  
### Вершинная теорема Менгера.  
  
<aside>  
❓ Максимальное число вершинно-непересекающихся путей между двумя несмежными вершинами связного графа $v,w$ равно минимальному числу вершин в $v,w$-отделяющем множестве.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Докажем по индукции.  
  
База: граф из $3$ вершин $v,u,w$ и $2$ ребер $vu,uw$.  
В этом графе есть единственный вершинно-непересекающийся путь $(v,u,w)$, а минимальное число вершин в $v,w$-отделяющем множестве равно $1:\{ u \}$.  
  
Индукционный переход.  
Утверждение выполнено для графов, в которых не более $n$ вершин и $m$ ребер.  
  
Пусть $\overline{V}~-~$наименьшее $v,w$-отделяющее множество размера $k$.  
Рассмотрим $3$ случая:  
  
1. В $\overline{V}$ есть вершины несмежные с $v$ и несмежные с $w$.  
2. Все вершины $\overline{V}$ смежны с $v$ или все смежны с $w$, но есть вершина $u$ смежная и с $v$, и с $w$ одновременно (считаем, что вершины смежны с $v$).  
3. Все вершины $\overline{V}$ смежны с $v$ или все смежны с $w$, и нет вершины смежной с $v$ и $w$ одновременно (считаем, что вершины смежны с $v$).  
  
$1)$ Поступим аналогично доказательству реберной теоремы.  
Удалим вершины $\overline{V}$ из $G$ и получаем два подграфа $V$ и $W$, содержащие $v$ и $w$ соответственно.  
  
Снова строим $G_1$ и $G_2$ из $G$.  
$G_1$ получается стягиванием ребер $V$ до $v$, а $G_2$ стягиванием ребер $W$ до $w$.  
  
$\overline{V}$ является минимальным $v,w$-отделяющим множеством для $G_1$ и $G_2$, которые удовлетворяют предположению индукции, а значит есть в каждом из графов есть $k$ вершинно-непересекающихся путей. Стыкуем их в $G$ и получаем то, что нужно.  
  
$2)$ Рассмотрим граф $G$ без вершины $u$. Для него будет выполняться предположение индукции и при том $\overline{V}\setminus \{ u \}$ будет минимальным $v,w$-отделяющим множеством. Тогда есть $k-1$ вершинно-непересекающийся путь, но $(v,u,w)$ не пересекается ни с одним из них, а значит, добавив его, получим $k$ путей.  
  
$3)$ Рассмотрим кратчайший вершинно-непересекающийся путь $(v,u_1,u_2,\dotsc,w)$ из $v$ в $w$. Понятно, что $u_2\notin \overline{V}$, так как в противном случае путь без $u_1$ был бы короче.  
  
В этом случае мы можем стянуть $u_2$ в $u_1$ и получить новый граф $G'$ с тем же $v,w$-отделяющим множеством. Для $G'$ работает предположение индукции, а значит есть $k$ вершинно-непересекающихся путей. Но ввиду построения $G'$ эти пути не будут пересекаться в $G$, а значит у нас есть $k$ вершинно-непересекающихся путей.  
  
</aside>  
  
### Следствия.  
  
<aside>  
❗ Граф называется реберно $k$-связным, если удаление любых $k-1$ ребер оставляет граф связным.  
  
Граф называется вершинно $k$-связным, если удаление любых $k-1$ вершин оставляет граф связным.  
  
</aside>  
  
<aside>  
❓ Граф $G$ является реберно $k$-связным $\Leftrightarrow$ любые две вершины соединяются по крайней мере $k$ реберно-непересекающимися путями.  
  
Граф $𝐺$ с как минимум $𝑘 + 1$ вершиной является вершинно $𝑘$-связным $\Leftrightarrow$ любые две различные вершины соединяются по крайней мере $𝑘$ вершинно-непересекающимися путями.  
  
</aside>  
  
В этих следствиях можно просто сказать о связи размера минимального раз(от)\деляющего множества и кол-ва реберно(вершинно)-непересекающихся путей.  
  
### Двудольный граф.  
  
<aside>  
❗ Граф называется двудольным, если $V(G)=V_1\cup V_2:V_1\cap V_2=\varnothing$ и $V_1,V_2\ne\varnothing$, и при том $\forall e=uv\in E(G) ~~ u\in V_1,v\in V_2$.  
  
$V_1$ называют множество начал, а $V_2$ множество концов двудольного графа.  
  
Полный двудольный граф $-$ двудольный граф $:\forall v\in V_1 ,u\in V_2 ~~  vu\in E(G)$.  
  
Паросочетание $-$ множество $M\subset E(G):\forall e_1\ne e_2\in M ~~ e_1\cap e_2$ (не пересекаются вершинами).  
  
$I\subset V_1,J\subset V_2$ будем называть множеством начал и множеством концов ребер паросочетания на двудольном графе соответственно.  
Тогда $M$ можно задать следующим образом: $\phi:I\xrightarrow{bi}J\Leftrightarrow \phi(i)=j\Rightarrow ij\in M$.  
  
Максимальным паросочетанием $M$ называется паросочетание, такое что любое ребро из $G$ пересекается с каким-то ребром $M$, то есть мы не можем добавить какое-либо ребро так, чтобы оно было несмежным к ребрам в $M$.  
  
Наибольшим паросочетанием $M$ называется паросочетание, имеющее наибольшее возможное число ребер.  
  
Наибольшее паросочетание $\Rightarrow$ максимальное, но не наоборот.  
  
</aside>  
  
<aside>  
🔑 Пример максимальных паросочетаний.  
  
![Untitled](/sem2/семестр/Дискретка (Мокаев)/Конспекты/Графы/Untitled 2.png)  
  
</aside>  
  
<aside>  
🔑 Пример наибольших паросочетаний.  
  
![Untitled](/sem2/семестр/Дискретка (Мокаев)/Конспекты/Графы/Untitled 3.png)  
  
</aside>  
  
### Теорема о максимальном паросочетании (лемма Бержа).  
  
<aside>  
❗ Чередующаяся цепь $-$ путь в двудольном графе, для которого верно, что ребра в пути чередуются: одно в паросочетание, одно $-$ нет.  
  
Дополняющая цепь $-$ чередующаяся цепь, у которой крайние вершины не заняты паросочетанием.  
  
Уменьшающая цепь $-$ чередующаяся цепь, у которой крайние вершины находятся в паросочетании.  
  
Сбалансированная цепь $-$ чередующаяся цепь, у которой одна крайняя вершина находится в паросочетании, а другая $-$ нет.  
  
</aside>  
  
<aside>  
❓ Паросочетание $M$ в двудольном графе $G$ является наибольшим $\Leftrightarrow$ в $G$ нет дополняющей цепи.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> $\Rightarrow:$  
Предположим, что дополняющая цепь есть. Пройдёмся по ребрам этой цепи и заменим ребра, входящие в паросочетание, на невходящие. Получим большее паросочетание и придём к противоречию.  
  
$\Leftarrow:$  
Предположим что $M~-~$не наибольшее паросочетание. Покажем, что есть дополняющая цепь относительно $M$.  
  
Возьмём паросочетание $M':|M'|>|M|$ и рассмотрим подграф $H\le G$, такой что $\forall e\in E(H) ~~ e\in M~||~e\in M'$.  
Заметим, что все вершины $H$ имеют степень $\le2$, так как в противном случае $2$ ребра из паросочетания $M$ или $M'$ будут пересекаться. Тогда компоненты связности вершин $H~-~$пути между $2$ точками или циклы, а значит ребра из $M'$ и $M$ будут чередоваться, образуя чередующуюся цепь.  
  
Так как $|M'|>|M|$, то есть компонента связности, в которой ребер из $M'$ больше, а значит это дополняющая цепь. Получили противоречие с условием.  
  
</aside>  
  
### Лемма о размере паросочетания.  
  
<aside>  
❗ Совершенным паросочетанием называется паросочетание, в котором каждая вершина графа инцидентна ребру паросочетания (паросочетание, в котором участвуют все вершины графа).  
  
$C\subset V(G)~-~$контролирующее множество, если $\forall e\in E(G) ~~ C\cap e\ne\varnothing$.  
  
</aside>  
  
<aside>  
❓ Размер любого паросочетания не больше размера любого контролирующего множества.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Пусть $M~-~$паросочетание.  
  
Предположим, что $\exists C:|M|>|C|$. Тогда $\exists u\in C:\exists e_1\ne e_2\in M:e_1\cap e_2=u$, так как $\forall e\in E(G)$ (в частности $\in M$) $e\cap C\ne \varnothing$, а значит по принципу Дирихле найдётся вершина, в которой пересекаются $2$ ребра.  
Получили противоречие с определением паросочетания, а значит $|M|\le |C|$.  
  
</aside>  
  
### Теорема Кёнига.  
  
<aside>  
❓ Размер наибольшего паросочетания равен размеру наименьшего контролирующего множества.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> Пусть $M~-~$наибольшее паросочетание в $G$, $U_1~-~$множество вершин, непокрытых паросочетанием в $V_1$, $U_2~-~$вершины, непокрытые паросочетанием в $V_2$.  
  
Обозначим $Y_1~-~$вершины, покрытые паросочетанием в $V_1$, до которых можно добраться от $U_1$ по чередующимся путям (обзовём их $M$-путями), а $Z_1~-~$вершины, покрытые паросочетанием в $V_1$, до которых таким образом добраться нельзя.  
  
Обозначим $Y_2~-~$вершины, покрытые паросочетанием в $V_2$, до которых можно добраться от $U_1~(!)$ по чередующимcя путям ($M$-пути), а $Z_2~-~$вершины, покрытые паросочетанием в $V_2$, до которых таким образом добраться нельзя.  
  
$M$-пути приходят в вершины $Y_1$ по ребрам из $M$ (начинаем идти из $U_1$, а значит первое ребро $\notin M$, тогда следующее ребро должно $\in M$, но так как мы из $V_1$ возвращаемся в $V_1$, шагов будет четное количество, а значит последнее ребро $\in M$). Так как этот путь чередующийся, то он останется чередующимся без последнего ребра, а значит предпоследняя вершина находится в $Y_2$.  
  
Ребра из $M$ не могут соединять вершины из $Y_2$ и $Z_1$, так как в противном случае получим противоречие, так как будет чередующаяся цепь в $Z_1$.  
  
Также ребра из $M$ не могут соединять вершины из $Y_1$ и $Z_2$, так как тогда $2$ ребра из паросочетания будут пересекаться по вершине из $Y_1$.  
  
Тогда ребра из $M$ соединяют $Y_1$ с $Y_2$ и $Z_1$ с $Z_2\Rightarrow|Y_1|=|Y_2|$ и $|Z_1|=|Z_2|$.  
  
Докажем, что $Z_1\cup Y_2~-~$контролирующее множество.  
Ребра не из $𝑀$ не могут соединять вершины из $𝑈_1 \cup 𝑌_1$ c вершинами из $𝑍_2$, так как в противном случае будет чередующийся путь до $Z_2$, что $?!$ определению $Z_2$ (если есть ребро $\notin M$ из $Y_1$ в $Z_2$, то чередующийся путь в $Z_2$ есть, так как он есть для всех вершин из $Y_1$; если есть ребро $\notin M$ из $U_1$ в $Z_2$, то будет чередующийся путь в $Z_1$).  
  
Не существует ребер из $U_2$ в $U_1\cup Y_1$, иначе есть дополняющая цепь, что противоречит максимальности паросочетания $M$ (если есть ребро из $U_2$ в $U_1$, то его можно добавить в паросочетание; если есть ребро из $U_2$ в $Y_1$, то у нас образовалась дополняюшая цепь, так как есть чередующаяся цепь для вершин из $Y_1$).  
  
Тогда у нас могут быть ребра только между $Y_1,Y_2;~Z_1,Z_2;~U_1,Y_2;~U_2,Z_1$. Каждая пара содержит либо $Z_1$ либо $Y_2\Rightarrow$ $Z_1\cup Y_2~-~$контролирующее множество.  
  
Так как $|B|=|Z_1|+|Y_2|=|M|$, то теорема доказана.  
  
</aside>  
  
### Теорема Холла.  
  
<aside>  
❗ Пусть $v\in V(G)$, $U\subset V(G)$.  
  
$N(v)~-~$множество всех вершин, смежных с $v$ (окрестность).  
  
$N'(U)~-~$множество вершин, смежных с вершинами $U$.  
  
$N(U)=N'(U)\setminus U~-~$окрестность $U$.  
  
</aside>  
  
<aside>  
❓ В двудольном графе есть паросочетание покрывающее все вершины $V_1$ $\Leftrightarrow$ для любого множества $U\subset V_1$ выполняется $|U|\le|N(U)|$.  
  
</aside>  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> $\Rightarrow:$ очевидно, так как есть паросочетание.  
  
$\Leftarrow:$  
Докажем индукцией по кол-ву вершин в $V_1$.  
  
База $n=1$.  
Так как неравенство выполняется, то вершина из $V_1$ точно имеет ребро в $V_2$, а значит можно взять это ребро в качестве паросочетания. База выполняется.  
  
Индукционный переход $n-1\mapsto n$.  
  
$1)~\exists A\subset V_1:|A|=|N(A)|$.  
Тогда, так как $\forall a\in A$ выполнено $|\{ a \}|\le |N(\{ a \})|$, то есть каждой вершине $A$ можно подобрать вершину из $V_2$, есть паросочетание на вершинах $A$.  
  
Рассмотрим оставшиеся $|V_1|-|A|$ вершин. Для них выполняется индукционное предположение, а значит есть паросочетание из $|V_1|-|A|$ вершин. Объединяем эти паросочетания и готово.  
  
$2)$ $\forall A\in V_1$ верно $|A|<|N(A)|$.  
Возьмём вершину из $V_1$ и смежную вершину из $V_2$. Удалим их из рассмотрения. Для оставшихся вершин будет выполняться предположение индукции. Тогда возьмём паросочетание, полученное из предположения, и добавим ребро, составленное из удаленных вершин.  
  
</aside>  
  
<aside>  
❓ В регулярном графе (все степени вершин одинаковы) есть совершенное паросочетание.  
  
</aside>  
  
### Алгоритм Куна.  
  
По сути применение леммы Бержа.  
  
<aside>  
⚙ Дан двудольный граф $G=(V_1,V_2,E):|V_1|=n,|V_2|=m$.  
  
1. Берем пустое паросочетание.  
2. Проходим по вершинам одной из долей и ищем дополняющую цепь.  
Если удалось найти, заменяем ребра из паросочетания на ребра не из паросочетания.  
3. Повторяем шаг $2$, пока не просмотрим все вершины.  
  
Искать дополняющую цепь можно обходом в глубину, либо в ширину.  
  
</aside>  
  
<aside>  
🔑 Пример применения алгоритма.  
  
![Untitled](/sem2/семестр/Дискретка (Мокаев)/Конспекты/Графы/Untitled 4.png)  
  
</aside>  
  
## Задача о назначениях. Венгерский метод.  
  
Пусть на двудольном графе $G$ задана функция веса $l:E(G)\to \mathbb{N}_0$.  
  
Заведем матрицу $L\in M_n:\forall e=ij\in E(G) ~~ L[i,j]=l(e)$.  
  
<aside>  
❗ Весом паросочетания $M$ будем называть сумму весов ребер, входящих в это паросочетание: $l(M)=\displaystyle\sum_{e\in M}l(e)$.  
  
</aside>  
  
Мы хотим построить наибольшее паросочетание с минимальным весом (будем делать это для полного двудольного графа с долями равной мощности).  
  
Напишем формально формулировку задачи:  
  
Пусть $G~-~$полный двудольный граф с долями $I$ и $J:\|I\|=\|J\|=n$. Нужно построить биекцию $\phi:I\to J~\|~l(\phi)=l(M)~-~$минимально, где $M=\\{ e=(i,\phi(i)~\|~i\in I \\}$.  
  
### Допустимые преобразования.  
  
<aside>  
❓ Возьмём произвольное $i_0\in I$ и $\alpha\in \mathbb{Z}$.  
  
Пусть $L'[i,j]=L[i,j]+\alpha$, если $i=i_0$, и $L'[i,j]=L[i,j]$ иначе.  
  
Тогда для произвольной $\phi:I\xrightarrow{bi} J$ верно, что $l'(\phi)=l(\phi)+\alpha$.  
  
</aside>  
  
По сути взяли какую-то строку и добавили к каждому значению в строке какое-то число.  
  
<aside>  
<img src="https://www.notion.so/icons/triangle-alternate_gray.svg" alt="https://www.notion.so/icons/triangle-alternate_gray.svg" width="40px" /> В каждом максимальном паросочетании ровно одно из ребер выходит из $i_0$. Веса других ребер в паросочетании не были затронуты.  
  
</aside>  
  
Аналогичная лемма есть для столбцов.  
  
<aside>  
❗ Такие преобразования будем называть допустимыми.  
  
</aside>  
  
Пусть $L'$ получена из матрицы $L$ конечной последовательностью допустимых преобразований. Тогда, если $\phi_1,\phi_2~-~$максимальные паросочетания и $l(\phi_1)\le l(\phi_2)$, то отсюда следует, что $l'(\phi_1)\le l'(\phi_2)$.  
  
<aside>  
❓ Если веса всех ребер графа неотрицательны и некоторое полное паросочетание состоит из ребер нулевого веса, то оно является оптимальным (очев).  
  
</aside>  
  
### Венгерский метод.  
  
$1)$ В каждой строке найдём минимум и вычтем его из этой строки. Затем делаем то же самое, но уже для столбоцв. Получится матрица $L_0$, в которой в каждом столбце и в каждой строке есть хотя бы $1$ ноль.  
  
$2)$ Рассмотрим $G_0\le G:G_0=\big(V(G),E_0\big)$, где $E_0=\{ e\in E(G)~\|~l_0(e)=0 \}$, то есть подграф на ребрах с нулевым весом.  
  
Пусть $\phi_0~-~$функция наибольшего паросочетания на $G_0$. Она задаёт $M_0\subset E(G)$.  
  
Пусть $C_0~-~$минимальное контролирующее множество для $G_0$. Тогда $\|C_0\|=\|M_0\|$.  
  
Если $\|M_0\|=n$, то решение найдено.  
  
Если $|M_0|<n$, то $C_0$ можно предствить как $C_0=I_0\cup J_0$, где $I_0\subset I$ и $J_0\subset J$.  
Определим $\delta:=\displaystyle\min_{i\notin I_0,j\notin J_0}L[i,j]~-~$вес минимального ребра, не контролируемого $C_0$.  
  
Теперь вычтем $\delta$ из всех неподконтрольных строк: $\forall i\notin I_0,j\in J ~~ L_{0}'[i,j]=L_0[i,j]-\delta$.  
Добавим $\delta$ ко всем подконтрольным столбцам: $\forall i\in I,j\in J_0 ~~ L_1[i,j]=L_0'[i,j]+\delta$.  
  
Возьмём наибольшее паросочетание $\psi$  в $G:l_1(\psi)=l_0(\psi)-\delta(n-\|I_0\|)+\delta\|J_0\|$.  
Тогда $l_1(\psi)=l_0(\psi)-\delta(n-\|I_0\|-\|J_0\|)=l_0(\psi)-\delta(n-\|C_0\|)<l_0(\psi)$, так как $C_0<n$.  
  
$3)$ Возвращаемся к шагу $1$. После шага $2)$ вес паросочетания уменьшился.  
