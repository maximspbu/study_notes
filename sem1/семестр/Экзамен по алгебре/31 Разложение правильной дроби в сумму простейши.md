---  
layout: mathjax  
---  
  
# 31. Разложение правильной дроби в сумму простейших.  
  
### *Определение. Простейшая дробь.*  
Рациональная дробь $\dfrac{f}{g}$ называется простейшей, если её знаменатель представляет собой степень неприводимого многочлена, то есть  
$g=q^n$, где $q~-~$неприводимый, и $\deg f < \deg g$.  
  
### *Представление произвольной дроби в виде правильной.*  
Пусть даны два многочлена $P,Q\in F[x]$. Рассмотрим два случая:  
$1)~\deg P > \deg Q$  
В этом случае поделим $P$ на $Q$ с остатком:  
$P=Q\cdot S + R;\quad\deg R < \deg Q$  
$\dfrac{P}{Q}=\dfrac{Q\cdot S + R}{Q}=S + \dfrac{R}{Q}$, где $\dfrac{R}{Q}~-~$правильная дробь  
$2)~\deg P < \deg Q$  
В этом случае у нас уже есть правильная дробь.  
  
### *Лемма 1. Разложение правильной дроби в сумму дробей.*  
$\dfrac{P}{Q}~-~$правильная дробь, т.е. $\deg P < \deg Q$  
Пусть $Q$ имеет вид $Q=F\cdot G;\quad НОД(F,G)=1$.  
Тогда $\exists A_0, B_0:\dfrac{P}{Q}=\dfrac{P}{FG}=\dfrac{A_0}{F}+\dfrac{B_0}{G}$ и все дроби правильные.  
  
### Доказательство:  
Мы хотим получить разложение в виде:  
$\dfrac{P}{F\cdot G}=\dfrac{A}{F}+\dfrac{B}{G}$, где $A,B\in F[x].$  
Выразим $P$: $P=AG+BF$  
Так как $НОД(F,G)=1$, то $\exists f,g\in F[x]:Ff+Gg=1$  
Умножим это равенство на $P$:  
$$\begin{cases}  
P=PFf+PGg  
\\  
P=BF + AG  
\end{cases}\Rightarrow A=Pg,B=Pf$$.  
То есть такое разложение существует.  
Поделим $A$ на $F$ с остатком:  
$A=FT + A_0;\quad\deg A_0 < \deg F$  
$P=AG+BF=G(FT + A_0)+BF=A_0G+\underbrace{(GT+B)}_{B_0}F$  
Теперь проверим, что в $\dfrac{P}{FG}=\dfrac{A_0}{F}+\dfrac{B_0}{G}$ все дроби правильные.  
Из условия знаем, что $\deg P<\deg Q$.  
Тогда, так как $Q=FG$, то $\deg P < \deg (FG)=\deg F+\deg G$  
$\deg A_0G=\deg A_0 + \deg G<\deg F +\deg G$ (т.к. $\deg A_0<\deg F)$  
Можем оценить степень последнего слагаемого, преобразовав $B_0F$:  
$$\begin{cases}  
A=FT+A_0  
\\  
P=BF + AG  
\\  
B_0F=(GT + B)F  
\end{cases} \Rightarrow B_0F=AG-A_0G+BF=P-A_0G$$  
$\deg \big((GT+B)F\big)= \deg(P-A_0G) < \deg F + \deg G$  
Тогда $\deg B_0 F<\deg F + \deg G\Rightarrow \deg B_0 < \deg G$  
$P=A_0G+B_0F;\quad\deg A_0 < \deg F; \deg B_0 < \deg G$  
$\dfrac{P}{FG}=\dfrac{A_0}{F}+\dfrac{B_0}{G}~-~$сумма правильных дробей  $\scriptsize\blacksquare$  
  
### *Лемма 2. Разложение дроби в сумму правильных для знаменателя в виде произведения неприводимых.*  
Пусть $Q$ имеет вид: $Q=q_1^{k_1}q_2^{k_2}...q_n^{k_n}$.  
При этом $НОД(q_i,q_j)=1 ~~ \forall i\ne j$ и $q_i~-~$неприводимые.  
Тогда $\exists!~p_1,...,p_n\in F[x]:\dfrac{P}{Q}=\dfrac{p_1}{q_1^{k_1} }+...+\dfrac{p_n}{q_n^{k_n} }$ и $\deg p_i < \deg q_i^{k_i}$.  
  
### Доказательство:  
Так как $НОД(q_i,q_j)=1  ~~  \forall i\ne j$, то, пользуясь первой леммой:  
$\dfrac{P}{Q}=\dfrac{P}{q_1^{k_1}\Big(q_2^{k_2}...q_n^{k_n}\Big)}\stackrel{Лемма~1}=\dfrac{p_1}{q_1^{k_1} }+\dfrac{A}{q_2^{k_2}...q_n^{k_n} }$.  
Продолжим раскладывать $\dfrac{A}{q_2^{k_2}...q_n^{k_n} }$, пока не получим все $n$ слагаемых:  
$\dfrac{P}{Q}=\dfrac{p_1}{q_1^{k_1} }+...+\dfrac{p_n}{q_n^{k_n} }~-~$сумма правильных дробей.  
Докажем единственность такого представления.  
Предположим, что есть 2 таких разложения:  
$\dfrac{P}{Q}=\dfrac{p_1}{q_1^{k_1} }+...+\dfrac{p_n}{q_n^{k_n} }=\dfrac{t_1}{q_1^{k_1} }+...+\dfrac{t_n}{q_n^{k_n} }$.  
Вычтем одно из другого и получим $0$:  
$\dfrac{p_1}{q_1^{k_1} }+...+\dfrac{p_n}{q_n^{k_n} }-\dfrac{t_1}{q_1^{k_1} }-...-\dfrac{t_n}{q_n^{k_n} }=0$  
Приведём слагаемые к одному знаменателю и вынесем $q_1^{k_1}$, где можно:  
$(p_1-t_1)q_2^{k_2}...q_n^{k_n}+q_1^{k_1}(...)=0$  
Тогда, так как $НОД(q_i, q_j)=1$, то $(p_1-t_1)~\vdots~q_1^{k_1}$  
$$\begin{cases}  
\deg(p_1-t_1)\le\max\\{ \deg p_1, \deg t_1 \\}  
\\  
\deg p_1 < \deg q_1^{k_1}  
\\  
\deg t_1 < \deg q_1^{k_1}  
\end{cases}\Rightarrow \deg(p_1-t_1)<\deg q_1^{k_1}$$  
Значит $p_1-t_1=0\Rightarrow p_1=t_1 ~~ \scriptsize\blacksquare$  
  
### *Лемма 3. Разложение правильной дроби со знаменателем в виде степени неприводимого многочлена в сумму правильных.*  
Пусть имеется $\dfrac{P_1}{Q_1}~-~$правильная дробь и $Q_1~-~$степень неприводимого многочлена, т.е. $Q_1=T_1^n$, где $T_1~-~$неприводимый многочлен и $\deg P_1<\deg Q_1$.  
Поделим $P_1$ на $T_1$ с остатком: $P_1=T_1S_1+R_1$  
$\dfrac{P_1}{Q_1}=\dfrac{P_1}{T_1^n}=\dfrac{T_1S_1+R_1}{T_1^n}=\dfrac{S_1}{T_1^{n-1} }+\dfrac{R_1}{T_1^n}$  
$\deg T_1S_1=\deg(P_1-R_1)<\deg T_1^n\Rightarrow\deg S_1 < \deg T_1^{n-1}$.  
Тогда имеем сумму правильных дробей.  
Продолжим разложение для $\dfrac{S_1}{T_1^{n-1} }$ и получим:  
 $\dfrac{P_1}{Q_1}=\dfrac{R_1}{T_1^n}+\dfrac{R_2}{T_1^{n-1} }+...+\dfrac{R_n}{T_1}$ при $\deg R_i < \deg T_1$.  
Такое разложение определяется единственным образом, так как остаток определяется однозначно.  
  
### Примеры разложения на простейшие.  
  
### $1.$ Разложить в сумму простейших $\dfrac{x}{x^4 -1}$  
Способ $1.$  
Вспомним про замечание для формулы Лагранжа:  
$f(x)=\displaystyle\sum_{i=1}^n \dfrac{f(x_i)\cdot \phi(x)}{f_i(x_i)(x-x_i)}$  
Можем вынести из суммы $\phi(x)$ и поделить на неё:  
$\dfrac{f(x)}{\phi(x)}=\displaystyle\sum_{i=1}^n \dfrac{f(x_i)}{f_i(x_i)(x-x_i)}$  
В нашем случае $\phi(x)=(x-1)(x+1)(x-i)(x+i)$, а $f(x)=x$.  
Тогда у нас есть $x_1 = 1,x_2=-1,x_3=i,x_4=-i$.  
Подставим их в формулу и получим:  
$\dfrac{x}{x^4-1}=\dfrac{1}{(1+1)(1-i)(1+i)(x-1)}+$  
$+\dfrac{-1}{(-1-1)(-1-i)(-1+i)(x+1)}+$  
$+\dfrac{i}{(i+1)(i-1)(i+i)(x-i)}+$  
$+\dfrac{-i}{(-i+1)(-i-1)(-i-i)(x+i)}=$  
$=\dfrac{1}{4(x-1)}+\dfrac{1}{4(x+1)}-\dfrac{1}{4(x-i)}-\dfrac{1}{4(x+i)}$  
Это разложение над полем $\mathbb{C}$, а, чтобы получить разложение над $\mathbb{R}$,  
нужно свести сопряжённые корни под один знаменатель:  
$\dfrac{x}{x^4-1}=\dfrac{1}{4(x-1)}+\dfrac{1}{4(x+1)}-\dfrac{2x}{4(x^2+1)}$  
  
Способ $2.$  
$\dfrac{x}{x^4 -1}=\dfrac{A}{x-1}+\dfrac{B}{x+1}-\dfrac{Cx+D}{x^2+1}~-~$для $\mathbb{R}$  
$\dfrac{x}{x^4 -1}=\dfrac{A}{4(x-1)}+\dfrac{B}{x+1}-\dfrac{C}{x-i}-\dfrac{D}{x+i}~-~$для $\mathbb{C}$.  
Сделаем для $\mathbb{R}$ (для $\mathbb{C}$ аналогично).  
Умножим обе части на $x^4-1$:  
$x=A(x+1)(x^2+1)+B(x-1)(x^2+1)-(Cx+D)(x^2-1)$  
Составим систему уравнений для коэффициентов перед степенями $x$:  
$$\begin{cases}  
0=A+B-C&x^3  
\\  
0=A-B-D&x^2  
\\  
1=A+B+C&x  
\\  
0=A-B+D&c  
\end{cases}\Rightarrow A=\dfrac{1}{4}=B; C=\dfrac{1}{2};D=0$$  
Получаем: $\dfrac{x}{x^4-1}=\dfrac{1}{4(x-1)}+\dfrac{1}{4(x+1)}-\dfrac{x}{2(x^2+1)}$  
  
### $2.$  Разложить в сумму простейших $\dfrac{4x}{(x-1)^2(x+1)^2}$  
$\dfrac{4x}{(x-1)^2(x+1)^2}=\dfrac{a}{x-1}+\dfrac{b}{(x-1)^2}+\dfrac{c}{x+1}+\dfrac{d}{(x+1)^2}$  
Умножим обе части на $(x-1)^2 (x+1)^2$:  
$4x=a(x-1) (x+1)^2 + b (x+1)^2 +c (x+1) (x-1)^2 + d (x-1)^2$  
Подставим $x=1:~4=4b\Rightarrow b= 1$  
Подставим $x=-1:-4=4d\Rightarrow d=-1$  
Преобразуем сумму, зная новые коэффициенты:  
$\dfrac{a}{x-1}+\dfrac{c}{x+1}=\dfrac{4x}{(x-1)^2(x+1)^2}-\dfrac{1}{(x-1)^2}+\dfrac{1}{(x+1)^2}$  
$\dfrac{a}{x-1}+\dfrac{c}{x+1}=\dfrac{4x-x^2-2x-1+x^2-2x+1}{(x-1)^2(x+1)^2}$  
$\dfrac{a}{x-1}+\dfrac{c}{x+1}=0$  
Умножим обе части на $x^2-1$:  
$a(x+1)+c(x-1)=0$  
Подставим $x=1:a=0$  
Подставим $x=-1:c=0$  
Тогда $\dfrac{4x}{(x-1)^2(x+1)^2}=\dfrac{1}{(x-1)^2}-\dfrac{1}{(x+1)^2}$  
