---  
layout: mathjax  
---  
  
# 17. Моделирование дискретной случайной величины с помощью последовательности случайных бит.  
  
### Определение. Псевдослучайный бит.  
$0$ или $1$ с равной вероятностью (бросок монетки).  
  
### *Моделирование ДСВ с помощью последовательности случайных бит.*  
Пусть есть ДСВ $\xi:\forall i\in 0:(n-1)  ~~  \Pr\\{\xi=i\\}=p_i$ и $\displaystyle\sum_{i=0}^{n-1}p_i=1$.  
Каждую вероятность можно представить в двоичном виде:  
$p_i=\dfrac{\pi_1^i}{2}+...+\dfrac{\pi_m^i}{2^m}$, где $\pi\in\\{0,1\\}$, а $m~-~$максимальное количество значащих двоичных цифр.  
Умножим обе части на $2^m$:  
$2^m\cdot p_i=2^{m-1}\cdot\pi_1^i+...+\pi_m^i$.  
  
### Рассмотрим множество $A$ исходов $m$ бросков монетки: $|A|=2^m$.  
Тогда можем построить разбиение:  
$A=A_0\cup...\cup A_{n-1}$, где $\forall i\in 0:(n-1) ~~ |A_i|=2^m\cdot p_i$.  
Проверка: $|A_0|+...+|A_{n-1}|=2^m\cdot\displaystyle\sum_{i=0}^{n-1}p_i=2^m$.  
Тогда, если исход эксперимента $"m$  бросков монетки$"$, то есть последовательность из $0$ и $1$, лежит в $A_i$, мы фиксируем $i$-тый исход.  
$\Pr\\{$попали в $A_i\\}=\dfrac{|A_i|}{2^m}=p_i$.  
  
### Далее можно построить полное двоичные дерево глубины $m$ и каким-то образом распределить листья по исходам так, чтобы количество листьев, соответствующих нужному исходу, было $2^m\cdot p_i$, а можно сделать хитрее.  
  
### Построим такое бинарное дерево, чтобы добираться до исхода за меньшее количество бросков монетки.  
Заведём множества $I_k=\\{i\in0:(n-1)~|~\pi^i_k=1\\} ~~ \forall k\in1:m$, в  
которых будут содержаться исходы с $1$ на $k$-ой позиции в двоичном представлении вероятности.  
  
### Теперь будем сопоставлять исходам двоичные строки, составленные из результатов бросков монетки.  
  
### Бросим монетку $1$ раз, и получим множество исходов $B_1:|B_1|=2$.  
Выберем подмножество $M_1\subset B_1:|M_1|=|I_1|=\displaystyle\sum_{i=0}^{n-1}\pi_1^i~-~$количество единиц на первой позиции. Установим биекцию между $M_1$ и $I_1$, то есть каждому исходу сопоставим битовую строку.  
Таким образом, для элементов из $M_1$ исход уже определён, а для  
$B_1\setminus M_1$ нужно продолжать бросать монетку.  
  
### Бросим монетку второй раз и получим $B_2:|B_2|=2*|B_1\setminus M_1|$.  
Далее применяем тот же алгоритм…  
  
### Бросим монетку $k$-ый раз. Тогда $B_k~-~$множество исходов после $k$ бросков монеты.  
Снова выберем $M_k\subset B_k:|M_k|=|I_k|$ и построим биекцию, а в остальных $B_k\setminus M_k$ продолжаем бросать монету.  
  
### Пример.  
  
$$\begin{cases}  
p_0=0,640625_{10}=0,101001_2  
\\  
p_1=0,015625_{10}=0,000001_2  
\\  
p_2=0,203125_{10}=0,001101_2  
\\  
p_3=0,140625_{10}=0,001001_2  
\end{cases}\Rightarrow P=1$$  
$I_1=\\{0\\};\quad  I_3=\\{0,2,3\\};\quad I_4=\\{2\\};\quad I_6=\\{0,1,2,3\\}$  
  
### Бросаем монетку: $B_1=\\{0, 1\\}\Rightarrow M_1=\\{1\\}$ (или $M_1=\\{0\\}$)  
Далее $B_2=\\{00, 01\\}\Rightarrow M_2=\\{\varnothing\\}$  
$B_3=\\{000, 001, 010, 011\\}\Rightarrow M_3=\\{000, 001, 011\\}$  
$B_4=\\{0100, 0101\\}\Rightarrow M_4=\\{0101\\}$  
$B_5=\\{01000, 01001\\}\Rightarrow M_5=\\{\varnothing\\}$  
$B_6=\\{010000, 010001, 010010, 010011\\}\Rightarrow M_6 = B_6$  
В результате получается дерево:  
  
![Untitled](/sem1/семестр/Экзамен по дискретной математике/17 Моделирование дискретной случайной величины/Untitled.png)  
  
### Тогда математическое ожидание бросков:  
$E\\{$число бросков$\\}=\displaystyle\sum_{k=1}^mk\cdot\Pr\\{$монета брошена $k$ раз$\\}=$    
$=\displaystyle\sum_{k=1}^mk\cdot |I_k|\cdot\dfrac{1}{2^k}=\displaystyle\sum_{k=1}^m\dfrac{k}{2^k}\cdot\displaystyle\sum_{j=0}^{n-1}\pi_k^i$  
  
### В нашем случае:  
$E\\{$число бросков$\\}=\dfrac{1}{2}\cdot1+\dfrac{3}{8}\cdot3+\dfrac{4}{16}\cdot1+\dfrac{6}{64}\cdot4=2,25$  
Если бы мы строили полное дерево, то матожидание бросков было бы равно $6$, так как для получения результата нужно было бы всегда бросать монетку $6$ раз.  
