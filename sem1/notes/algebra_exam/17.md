# 17. Китайская теорема об остатках (+500  Social credits + кошка жена + миска рис)

### *Лемма.*
Если $НОД(a,b)=1$, то $\exist c\in\Z:ac \equiv_b 1$ .

### Доказательство:
По теореме Эйлера возьмем $c = a^{\varphi(b)-1}$ тогда при умножении на $a$ получим $a^{\varphi(b)} \equiv_b 1~~\scriptsize\blacksquare$

### *Китайская теорема об остатках.*
Пусть $n_1,n_2,..,n_k\in\N$ попарно взаимно простые числа, а
$r_1,r_2..,r_k~-$ некоторые целые числа.
Тогда существует $M\in\Z$, которое будет решением системы сравнений:
$\begin{cases}M\equiv r_1~(mod~n_1)\\ M\equiv r_2~(mod~n_2)\\ ... \\M\equiv r_k~(mod~n_k) \end{cases}$
При этом для любых двух решений $A$ и $B$ этой системы справедливо
$A \equiv B  \ (mod \ n_1n_2..n_k)$, то есть решение системы сравнений существует и единственно по модулю $n_1n_2...n_k$.

### Доказательство:
Пусть $N = n_1n_2..n_k$, а $N_i = \dfrac{N}{n_i}$.
Тогда $(N_i, n_i)=1$, так как $n_i$ попарно взаимно просты.
По лемме, доказанной выше, $\exist M_i\in\Z:M_iN_i \equiv 1 \pmod{n_i}$ 
Домножив сравнение на $r_i$, получим: $M_iN_ir_i \equiv r_i\pmod{n_i}$
Докажем, что $M = M_1N_1r_1 + M_2N_2r_2 + ...+ M_kN_kr_k$ является решением системы.
Рассмотрим $i$-тое сравнение системы: $M_iN_ir_i\equiv r_i \pmod{n_i}$
$M_1N_1r_1 +...+ M_kN_kr_k \equiv M_iN_ir_i \pmod{n_i}$, так как во всех остальных членах есть $N_j~(j \not=i)$, в котором содержится $n_i$.
Но тогда $M \equiv M_iN_ir_i \equiv r_i ~(mod~n_i)$, то есть сравнение верно для произвольного сравнения системы $\Rarr$ оно верно для всех cравнений системы  $\tiny\blacksquare$

Докажем единственность решения.
Пусть $A$ и $B$ два различных решения системы.
Тогда для $A$ и для $B$ верны сравнения: $A\equiv r_i\equiv B\pmod{n_i}$.
Тогда $A\equiv B\pmod{n_i}$ для $1\le i \le k$.
Так как $n_i$ попарно просты, то $A\equiv B \pmod{n_1n_2..n_k=N}$.
Значит $A$ и $B$ находятся в одном классе по модулю $N$  $\scriptsize\blacksquare$