# 30. Интерполяционная формула Лагранжа.

### *Интерполяционная задача.*
Пусть даны $x_1,...,x_n\in F$ и $y_1,...,y_n\in F$. Нужно найти многочлен
$f(x):\deg f\le n-1$ и $f(x_i)=y_i$  $\forall i$.
Рассмотрим следующие многочлены:
$f_1(x)=(x-x_2)...(x-x_n)$
$f_2(x)=(x-x_1)(x-x_3)...(x-x_n)$
И так далее до $f_n(x)=(x-x_1)...(x-x_{n-1})$
Будем искать $f(x)$ в виде:
$f(x)=c_1f_1+...+c_nf_n$, где $c_i\in F$
Подставим $x_i$ в $f(x)$:
$f(x_i)=c_1f_1(x_i)+...+c_nf_n(x_i)=c_if_i(x_i)=y_i$
$c_i=\dfrac{y_i}{f_i(x_i)}=\dfrac{y_i}{(x-x_1)...(x-x_{i-1})(x-x_{i+1})...(x-x_n)}=\dfrac{f(x_i)}{f_i(x_i)}$.

$f(x)=\dfrac{y_1\cdot f_1(x)}{f_1(x_1)}+...+\dfrac{y_n\cdot f_n(x)}{f_n(x_n)}=\displaystyle\sum_{i=1}^n \dfrac{y_i\cdot f_i(x)}{f_i(x_i)}$.
$f(x)=\displaystyle\sum_{i=1}^n \dfrac{y_i\cdot f_i(x)}{f_i(x_i)}~-~$интерполяционная формула Лагранжа.

### *Замечание.* Формулу Лагранжа можно представлять в другом виде, если
вместо $f_i(x)$ писать $\dfrac{(x-x_1)...(x-x_n)}{x-x_i}=\dfrac{\phi(x)}{x-x_i}$.
Тогда формула примет вид: $f(x)=\displaystyle\sum_{i=1}^n \dfrac{f(x_i)\cdot \phi(x)}{f_i(x_i)(x-x_i)}$
Это пригодится при разложении дроби на сумму простейших.

### *Предложение.* Покажем, что интерполяционная задача решается единственным образом, то есть нужный многочлен - единственный.

### Доказательство:
Предположим противное. Пусть $p_1$  и $p_2~-~$два подходящих многочлена.
$p_1(x_i)=p_2(x_i)=y_i$ и $\deg p_1\le n - 1$, и $\deg p_2 \le n - 1$.
Рассмотрим разность этих многочленов $p_1 - p_2$.
В точках $x_i$ эта разность равна $0$ и $\deg(p_1-p_2)\le n - 1$, но тогда получается, что многочлен степени $\le n - 1$ имеет $n$ корней $?!$
Таким образом, нужный многочлен единственный  $\scriptsize\blacksquare$

### *Бонус. Метод Ньютона.*
Нужный многочлен также можно искать в виде:
$f(x)=a_0+a_1(x-x_1)+...+a_{n-1}(x-x_1)...(x-x_{n-1})$
$f(x_1)=y_1\Rarr a_0=y_1$
$f(x_2)=y_2\Rarr a_1 = \dfrac{y_2-y_1}{x_2-x_1}$
Так можем найти все коэффициенты.