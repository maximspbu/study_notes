# 26. Кривые второго порядка. Поворот системы координат.

# Купил англичанин шляпу, а она ему how one

### Уравнение кривой второго порядка:
$a_{11}x^2+a_{22}y^2+2a_{12}xy+2b_1x+2b_2y+b_3=0$.
Применим к этому уравнению следующие формулы:
$x=x'\cos\alpha-y'\sin\alpha$
$y=x'\sin\alpha+y'\cos\alpha$
Получим следующее равенство:
$a_{11}(x'\cos\alpha-y'\sin\alpha)^2+a_{22}(x'\sin\alpha+y'\cos\alpha)^2+
\\+2a_{12}(x'\cos\alpha-y'\sin\alpha)(x'\sin\alpha+y'\cos\alpha)+
\\+2b_1(x'\cos\alpha-y'\sin\alpha)+2b_2(x'\sin\alpha+y'\cos\alpha)+b_3=0$
Мы хотим избавиться от $a_{12}xy$. Подсчитаем коэффициент при $xy$:
$-2a_{11}\cos\alpha\sin\alpha+2a_{22}\cos\alpha\sin\alpha+2a_{12}(\cos^2\alpha-\sin^2\alpha)=0$
$-a_{11}\sin2\alpha+a_{22}\sin2\alpha+2a_{12}\cos2\alpha=0~~|:\sin2\alpha$
$-a_{11}+a_{22}+2a_{12}\ctg2\alpha=0$
$\ctg2\alpha=\dfrac{a_{11}-a_{22}}{2a_{12}}\Rarr\alpha\in\Big(0;\dfrac{\pi}{2}\Big)$.

### Примечание. Можем поделить на $a_{12}\ne0$, иначе в преобразованиях не было бы смысла.

### То есть мы нашли угол, на который нужно повернуть систему координат, чтобы избавиться от $a_{12}xy$.
После всех преобразований уравнение принимает вид:
$a_{11}'x'^{~2}+a_{22}'y'^{~2}+2b_1'x'+2b_2'y'+b_3'=0$

### Следующий шаг в преобразованиях $-$ сдвиги.

### Если $a_{11}'\ne0$, то сдвигами можно обнулить $b_1'$ (аналогично для $a_{22}'$):

$a_{11}'x'^{~2}+2b'_1x'=a'_{11}\Big(x'^{~2}+\dfrac{2b'_1}{a'_{11}}x'+\dfrac{b'^{~2}_1}{a'^{~2}_{11}}\Big)-\dfrac{b'^{~2}_1}{a'_{11}}=$

$=a'_{11}\Big(x'+\dfrac{b'_1}{a'_{11}}\Big)^2-\dfrac{b'^{~2}_1}{a'_{11}}=a'_{11}(x'')^{2}-\dfrac{b'^{~2}_1}{a'_{11}}$

### Если $a'_{11}=0,~b'_1\ne0$, то $b'_3$ можно обнулить следующим образом:

$2b'_1x'+b'_3=2b'_1\Big(x'+\dfrac{b'_3}{2b'_1}\Big)=2b'_1x''$
Для $a'_{22}=0, b'_2\ne0$ аналогичным образом обнуляется $b'_3$.